<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="LuxHaven360 — Eccellenza Senza Compromessi. Proprietà di prestigio, supercar e beni selezionati." />
  <title>LuxHaven360 — Eccellenza Senza Compromessi</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Jost:wght@200;300;400;500&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --black:    #080808;
      --dark:     #111111;
      --surface:  #181818;
      --border:   #2a2a2a;
      --gold:     #C9A84C;
      --gold-lt:  #e8c97a;
      --gold-dk:  #9a7d34;
      --cream:    #F4EFE6;
      --muted:    #888888;
      --white:    #FAFAF8;
      --font-disp: 'Cormorant Garamond', Georgia, serif;
      --font-body: 'Jost', 'Helvetica Neue', sans-serif;
      --ease: cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    html { scroll-behavior: smooth; font-size: 16px; }

    body {
      background: var(--black);
      color: var(--cream);
      font-family: var(--font-body);
      font-weight: 300;
      line-height: 1.7;
      overflow-x: hidden;
      cursor: default;
    }

    ::selection { background: var(--gold); color: var(--black); }

    /* ── SCROLLBAR ── */
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: var(--black); }
    ::-webkit-scrollbar-thumb { background: var(--gold-dk); border-radius: 2px; }

    /* ── GOLD GRADIENT TEXT ── */
    .gold { color: var(--gold); }
    .gold-text {
      background: linear-gradient(135deg, var(--gold-dk) 0%, var(--gold-lt) 50%, var(--gold-dk) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* ── NAV ── */
    nav {
      position: fixed; top: 0; left: 0; right: 0; z-index: 100;
      display: flex; align-items: center; justify-content: space-between;
      padding: 1.25rem 3rem;
      transition: background 0.4s var(--ease), backdrop-filter 0.4s;
    }
    nav.scrolled {
      background: rgba(8,8,8,0.92);
      backdrop-filter: blur(24px);
      border-bottom: 1px solid var(--border);
    }
    .nav-logo {
      font-family: var(--font-disp);
      font-size: 1.45rem;
      font-weight: 500;
      letter-spacing: 0.04em;
      color: var(--cream);
      text-decoration: none;
    }
    .nav-logo span { color: var(--gold); }
    .nav-links {
      display: flex; gap: 2.5rem; list-style: none;
      align-items: center;
    }
    .nav-links a {
      font-size: 0.7rem; letter-spacing: 0.18em; text-transform: uppercase;
      color: var(--muted); text-decoration: none; transition: color 0.3s;
    }
    .nav-links a:hover { color: var(--gold); }

    /* Lang switcher */
    .lang-switcher {
      display: flex; gap: 0.5rem; align-items: center;
    }
    .lang-btn {
      background: none; border: 1px solid transparent;
      color: var(--muted); font-family: var(--font-body);
      font-size: 0.65rem; letter-spacing: 0.12em; text-transform: uppercase;
      padding: 0.3rem 0.55rem; cursor: pointer;
      border-radius: 2px; transition: all 0.25s;
    }
    .lang-btn.active, .lang-btn:hover {
      color: var(--gold); border-color: var(--gold);
    }

    /* hamburger */
    .nav-toggle { display: none; flex-direction: column; gap: 5px; cursor: pointer; padding: 4px; }
    .nav-toggle span { width: 22px; height: 1px; background: var(--cream); transition: all 0.3s; display: block; }
    .nav-toggle.open span:nth-child(1) { transform: rotate(45deg) translate(4px, 4px); }
    .nav-toggle.open span:nth-child(2) { opacity: 0; }
    .nav-toggle.open span:nth-child(3) { transform: rotate(-45deg) translate(4px, -4px); }

    /* ── HERO ── */
    #hero {
      min-height: 100vh;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      text-align: center; position: relative; overflow: hidden;
      padding: 8rem 2rem 5rem;
    }

    .hero-bg {
      position: absolute; inset: 0; z-index: 0;
      background:
        radial-gradient(ellipse 80% 60% at 50% 30%, rgba(201,168,76,0.07) 0%, transparent 70%),
        radial-gradient(ellipse 50% 80% at 85% 80%, rgba(201,168,76,0.04) 0%, transparent 60%),
        var(--black);
    }
    .hero-lines {
      position: absolute; inset: 0; z-index: 0;
      background-image:
        linear-gradient(rgba(201,168,76,0.04) 1px, transparent 1px),
        linear-gradient(90deg, rgba(201,168,76,0.04) 1px, transparent 1px);
      background-size: 80px 80px;
      mask-image: radial-gradient(ellipse 80% 80% at center, black 20%, transparent 80%);
    }
    .hero-content { position: relative; z-index: 1; max-width: 900px; }

    .hero-eyebrow {
      display: inline-flex; align-items: center; gap: 1rem;
      font-size: 0.65rem; letter-spacing: 0.3em; text-transform: uppercase;
      color: var(--gold); margin-bottom: 2rem;
      opacity: 0; animation: fadeUp 0.8s var(--ease) 0.2s forwards;
    }
    .hero-eyebrow::before, .hero-eyebrow::after {
      content: ''; width: 40px; height: 1px; background: var(--gold); opacity: 0.5;
    }

    .hero-title {
      font-family: var(--font-disp);
      font-size: clamp(3.5rem, 9vw, 7.5rem);
      font-weight: 300; line-height: 1.05;
      letter-spacing: -0.01em;
      color: var(--cream);
      margin-bottom: 0.3em;
      opacity: 0; animation: fadeUp 1s var(--ease) 0.4s forwards;
    }
    .hero-title em { font-style: italic; color: var(--gold); }

    .hero-tagline {
      font-family: var(--font-disp);
      font-size: clamp(0.9rem, 2vw, 1.1rem);
      font-weight: 300; font-style: italic;
      color: var(--muted); letter-spacing: 0.15em;
      margin-bottom: 3rem;
      opacity: 0; animation: fadeUp 1s var(--ease) 0.6s forwards;
    }

    .hero-desc {
      font-size: clamp(0.85rem, 1.5vw, 0.95rem);
      color: rgba(244,239,230,0.6);
      max-width: 580px; margin: 0 auto 3.5rem;
      line-height: 1.9;
      opacity: 0; animation: fadeUp 1s var(--ease) 0.8s forwards;
    }

    .hero-cta {
      display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;
      opacity: 0; animation: fadeUp 1s var(--ease) 1s forwards;
    }

    .btn-primary {
      display: inline-flex; align-items: center; gap: 0.6rem;
      padding: 0.9rem 2.2rem;
      background: linear-gradient(135deg, var(--gold-dk), var(--gold), var(--gold-lt));
      color: var(--black);
      font-family: var(--font-body); font-size: 0.68rem;
      font-weight: 500; letter-spacing: 0.2em; text-transform: uppercase;
      text-decoration: none; border: none; cursor: pointer;
      position: relative; overflow: hidden; transition: transform 0.3s, box-shadow 0.3s;
    }
    .btn-primary::after {
      content: ''; position: absolute; inset: 0;
      background: linear-gradient(135deg, transparent, rgba(255,255,255,0.15), transparent);
      transform: translateX(-100%); transition: transform 0.5s;
    }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 12px 40px rgba(201,168,76,0.3); }
    .btn-primary:hover::after { transform: translateX(100%); }

    .btn-outline {
      display: inline-flex; align-items: center; gap: 0.6rem;
      padding: 0.9rem 2.2rem;
      background: transparent; border: 1px solid rgba(201,168,76,0.4);
      color: var(--gold);
      font-family: var(--font-body); font-size: 0.68rem;
      font-weight: 400; letter-spacing: 0.2em; text-transform: uppercase;
      text-decoration: none; cursor: pointer;
      transition: all 0.3s;
    }
    .btn-outline:hover {
      background: rgba(201,168,76,0.08); border-color: var(--gold);
      transform: translateY(-2px);
    }

    /* ── SECTIONS ── */
    section { padding: 7rem 2rem; }
    .container { max-width: 1160px; margin: 0 auto; }

    .section-label {
      font-size: 0.6rem; letter-spacing: 0.35em; text-transform: uppercase;
      color: var(--gold); margin-bottom: 1.2rem;
      display: flex; align-items: center; gap: 1rem;
    }
    .section-label::before { content: ''; width: 30px; height: 1px; background: var(--gold); }

    .section-title {
      font-family: var(--font-disp);
      font-size: clamp(2.2rem, 5vw, 3.8rem);
      font-weight: 300; line-height: 1.1;
      color: var(--cream); margin-bottom: 1.5rem;
    }
    .section-title em { font-style: italic; color: var(--gold); }

    .section-body {
      font-size: 0.92rem; color: rgba(244,239,230,0.6);
      max-width: 600px; line-height: 1.95;
    }

    /* divider */
    .divider {
      width: 100%; height: 1px;
      background: linear-gradient(90deg, transparent, var(--border), transparent);
      margin: 0;
    }

    /* ── ABOUT ── */
    #about { background: var(--black); }
    .about-grid {
      display: grid; grid-template-columns: 1fr 1fr;
      gap: 5rem; align-items: center;
    }
    .about-visual {
      position: relative; aspect-ratio: 3/4; max-height: 540px;
    }
    .about-card {
      background: var(--surface);
      border: 1px solid var(--border);
      width: 100%; height: 100%;
      display: flex; flex-direction: column; justify-content: flex-end;
      padding: 2.5rem; overflow: hidden;
      position: relative;
    }
    .about-card::before {
      content: '';
      position: absolute; inset: 0;
      background: linear-gradient(160deg, rgba(201,168,76,0.06) 0%, transparent 60%);
    }
    .about-card-number {
      font-family: var(--font-disp);
      font-size: 7rem; font-weight: 300;
      line-height: 1; color: rgba(201,168,76,0.07);
      position: absolute; top: 1.5rem; right: 1.5rem;
      letter-spacing: -0.05em;
    }
    .about-card-label {
      font-size: 0.6rem; letter-spacing: 0.3em; text-transform: uppercase;
      color: var(--gold); margin-bottom: 0.8rem; position: relative; z-index: 1;
    }
    .about-card-title {
      font-family: var(--font-disp);
      font-size: 1.8rem; font-weight: 300;
      color: var(--cream); line-height: 1.2; position: relative; z-index: 1;
    }
    .about-pillars {
      display: flex; flex-direction: column; gap: 1.2rem; margin-top: 2rem;
    }
    .pillar {
      display: flex; align-items: flex-start; gap: 1rem;
      padding: 1.2rem 1.5rem;
      border: 1px solid var(--border); background: var(--surface);
      transition: border-color 0.3s, transform 0.3s;
    }
    .pillar:hover { border-color: rgba(201,168,76,0.3); transform: translateX(4px); }
    .pillar-icon {
      width: 32px; height: 32px; flex-shrink: 0;
      border: 1px solid var(--gold-dk);
      display: flex; align-items: center; justify-content: center;
      font-size: 0.9rem; color: var(--gold);
    }
    .pillar-text h4 {
      font-family: var(--font-disp);
      font-size: 1.05rem; font-weight: 400; color: var(--cream);
      margin-bottom: 0.2rem;
    }
    .pillar-text p { font-size: 0.8rem; color: var(--muted); line-height: 1.6; }

    /* ── ACTIVITIES ── */
    #activities { background: var(--dark); }
    .activities-header {
      display: flex; justify-content: space-between; align-items: flex-end;
      margin-bottom: 4rem; flex-wrap: wrap; gap: 2rem;
    }
    .activities-grid {
      display: grid; grid-template-columns: repeat(3, 1fr);
      gap: 1px; background: var(--border);
    }
    .activity-card {
      background: var(--dark); padding: 2.5rem 2rem;
      position: relative; overflow: hidden;
      transition: background 0.4s;
    }
    .activity-card:hover { background: var(--surface); }
    .activity-card::after {
      content: ''; position: absolute; bottom: 0; left: 0; right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--gold-dk), var(--gold));
      transform: scaleX(0); transform-origin: left;
      transition: transform 0.4s var(--ease);
    }
    .activity-card:hover::after { transform: scaleX(1); }
    .activity-num {
      font-family: var(--font-disp);
      font-size: 3rem; font-weight: 300;
      color: rgba(201,168,76,0.15); line-height: 1;
      margin-bottom: 1rem;
    }
    .activity-title {
      font-family: var(--font-disp);
      font-size: 1.35rem; font-weight: 400;
      color: var(--cream); margin-bottom: 0.8rem;
    }
    .activity-desc { font-size: 0.8rem; color: var(--muted); line-height: 1.8; }
    .activity-tag {
      display: inline-block; margin-top: 1.5rem;
      font-size: 0.55rem; letter-spacing: 0.2em; text-transform: uppercase;
      color: var(--gold); border: 1px solid rgba(201,168,76,0.3);
      padding: 0.25rem 0.7rem;
    }

    /* ── BENEFITS ── */
    #benefits { background: var(--black); }
    .benefits-layout {
      display: grid; grid-template-columns: 1fr 1.2fr;
      gap: 5rem; align-items: center;
    }
    .benefits-list { display: flex; flex-direction: column; gap: 0; }
    .benefit-item {
      display: flex; gap: 1.5rem; align-items: flex-start;
      padding: 1.8rem 0; border-bottom: 1px solid var(--border);
      transition: transform 0.3s;
    }
    .benefit-item:first-child { border-top: 1px solid var(--border); }
    .benefit-item:hover { transform: translateX(6px); }
    .benefit-num {
      font-family: var(--font-disp);
      font-size: 0.75rem; font-weight: 400;
      color: var(--gold); min-width: 24px; margin-top: 0.2rem;
    }
    .benefit-content h4 {
      font-family: var(--font-disp);
      font-size: 1.2rem; font-weight: 400;
      color: var(--cream); margin-bottom: 0.4rem;
    }
    .benefit-content p { font-size: 0.8rem; color: var(--muted); line-height: 1.7; }

    .benefits-right { position: relative; }
    .benefits-visual {
      background: var(--surface); border: 1px solid var(--border);
      padding: 3rem 2.5rem; position: relative; overflow: hidden;
    }
    .benefits-visual::before {
      content: '';
      position: absolute; top: -60px; right: -60px;
      width: 200px; height: 200px;
      border: 1px solid rgba(201,168,76,0.1);
      border-radius: 50%;
    }
    .benefits-visual::after {
      content: '';
      position: absolute; top: -30px; right: -30px;
      width: 120px; height: 120px;
      border: 1px solid rgba(201,168,76,0.08);
      border-radius: 50%;
    }
    .stat-row {
      display: grid; grid-template-columns: 1fr 1fr;
      gap: 2rem; margin-bottom: 2.5rem;
    }
    .stat { text-align: center; padding: 1.5rem 0; border: 1px solid var(--border); }
    .stat-num {
      font-family: var(--font-disp);
      font-size: 2.5rem; font-weight: 300;
      color: var(--gold); line-height: 1; margin-bottom: 0.4rem;
    }
    .stat-label { font-size: 0.6rem; letter-spacing: 0.2em; text-transform: uppercase; color: var(--muted); }
    .quote-block {
      border-left: 2px solid var(--gold);
      padding-left: 1.5rem; margin-top: 1.5rem;
    }
    .quote-block p {
      font-family: var(--font-disp);
      font-size: 1.15rem; font-weight: 300; font-style: italic;
      color: var(--cream); line-height: 1.6;
    }
    .quote-block cite {
      display: block; margin-top: 0.8rem;
      font-size: 0.6rem; letter-spacing: 0.2em; text-transform: uppercase;
      color: var(--gold); font-style: normal;
    }

    /* ── SUBSCRIPTIONS ── */
    #subscriptions { background: var(--dark); }
    .plans-header { text-align: center; margin-bottom: 4rem; }
    .plans-header .section-label { justify-content: center; }
    .plans-header .section-label::before { display: none; }
    .plans-header .section-body { margin: 0 auto; text-align: center; max-width: 520px; }

    .plans-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem; align-items: stretch;
    }
    .plan-card {
      background: var(--surface); border: 1px solid var(--border);
      padding: 2.5rem 2rem;
      position: relative; overflow: hidden;
      display: flex; flex-direction: column;
      transition: transform 0.3s, border-color 0.3s;
    }
    .plan-card:hover { transform: translateY(-6px); }
    .plan-card.featured {
      border-color: var(--gold);
      background: linear-gradient(160deg, rgba(201,168,76,0.06) 0%, var(--surface) 50%);
    }
    .plan-badge {
      position: absolute; top: 1.5rem; right: 1.5rem;
      font-size: 0.55rem; letter-spacing: 0.2em; text-transform: uppercase;
      background: var(--gold); color: var(--black);
      padding: 0.25rem 0.7rem; font-weight: 500;
    }
    .plan-tier {
      font-size: 0.6rem; letter-spacing: 0.3em; text-transform: uppercase;
      color: var(--gold); margin-bottom: 1rem;
    }
    .plan-name {
      font-family: var(--font-disp);
      font-size: 2rem; font-weight: 300;
      color: var(--cream); margin-bottom: 0.5rem;
    }
    .plan-price {
      display: flex; align-items: baseline; gap: 0.3rem;
      margin: 1.5rem 0;
    }
    .plan-price .amount {
      font-family: var(--font-disp);
      font-size: 3rem; font-weight: 300;
      color: var(--gold); line-height: 1;
    }
    .plan-price .currency {
      font-size: 1.2rem; color: var(--gold-dk);
      font-family: var(--font-disp);
    }
    .plan-price .period {
      font-size: 0.72rem; color: var(--muted);
      letter-spacing: 0.1em;
    }
    .plan-desc {
      font-size: 0.78rem; color: var(--muted);
      line-height: 1.7; margin-bottom: 1.5rem;
    }
    .plan-features {
      list-style: none; flex: 1;
      display: flex; flex-direction: column; gap: 0.75rem;
      margin-bottom: 2rem;
    }
    .plan-features li {
      display: flex; align-items: flex-start; gap: 0.75rem;
      font-size: 0.8rem; color: rgba(244,239,230,0.75); line-height: 1.5;
    }
    .plan-features li::before {
      content: '◆'; color: var(--gold); font-size: 0.45rem;
      flex-shrink: 0; margin-top: 0.35rem;
    }
    .plan-features li.dim { color: var(--muted); }
    .plan-features li.dim::before { color: var(--border); }
    .plan-cta {
      display: block; text-align: center;
      padding: 0.9rem; font-size: 0.65rem;
      letter-spacing: 0.2em; text-transform: uppercase;
      text-decoration: none; border: 1px solid rgba(201,168,76,0.4);
      color: var(--gold); font-weight: 400; font-family: var(--font-body);
      transition: all 0.3s; cursor: pointer; background: none;
    }
    .plan-cta:hover, .plan-card.featured .plan-cta {
      background: var(--gold); color: var(--black);
      border-color: var(--gold);
    }
    .plan-card.featured .plan-cta:hover {
      background: var(--gold-lt); border-color: var(--gold-lt);
    }
    .plans-note {
      text-align: center; margin-top: 2.5rem;
      font-size: 0.72rem; color: var(--muted); line-height: 1.7;
    }
    .plans-note span { color: var(--gold); }

    /* ── COMMUNITY ── */
    #community {
      background: var(--black);
      position: relative; overflow: hidden;
    }
    #community::before {
      content: '';
      position: absolute; top: 0; left: 50%; transform: translateX(-50%);
      width: 600px; height: 600px;
      background: radial-gradient(circle, rgba(201,168,76,0.05) 0%, transparent 70%);
      pointer-events: none;
    }
    .community-inner {
      text-align: center; max-width: 700px; margin: 0 auto;
      position: relative; z-index: 1;
    }
    .community-inner .section-label { justify-content: center; }
    .community-inner .section-label::before { display: none; }
    .community-inner .section-title { margin-bottom: 1.5rem; }
    .community-inner .section-body { margin: 0 auto 3rem; text-align: center; }
    .community-ornament {
      font-family: var(--font-disp);
      font-size: 8rem; font-weight: 300;
      color: rgba(201,168,76,0.06); line-height: 1;
      position: absolute; top: -2rem; left: 50%; transform: translateX(-50%);
      pointer-events: none; white-space: nowrap;
    }

    /* ── FOOTER ── */
    footer {
      background: var(--dark);
      border-top: 1px solid var(--border);
      padding: 3rem 2rem;
    }
    .footer-inner {
      max-width: 1160px; margin: 0 auto;
      display: flex; justify-content: space-between; align-items: center;
      flex-wrap: wrap; gap: 1.5rem;
    }
    .footer-logo {
      font-family: var(--font-disp);
      font-size: 1.1rem; font-weight: 400; color: var(--cream);
    }
    .footer-logo span { color: var(--gold); }
    .footer-tagline { font-size: 0.65rem; letter-spacing: 0.2em; color: var(--muted); margin-top: 0.3rem; }
    .footer-copy { font-size: 0.7rem; color: var(--muted); letter-spacing: 0.05em; }

    /* ── ANIMATIONS ── */
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(24px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .reveal {
      opacity: 0; transform: translateY(28px);
      transition: opacity 0.8s var(--ease), transform 0.8s var(--ease);
    }
    .reveal.visible { opacity: 1; transform: translateY(0); }
    .reveal-delay-1 { transition-delay: 0.1s; }
    .reveal-delay-2 { transition-delay: 0.2s; }
    .reveal-delay-3 { transition-delay: 0.3s; }
    .reveal-delay-4 { transition-delay: 0.4s; }

    /* ── MOBILE ── */
    @media (max-width: 900px) {
      nav { padding: 1.2rem 1.5rem; }
      .nav-links { display: none; position: fixed; inset: 0; top: 60px;
        background: rgba(8,8,8,0.98); backdrop-filter: blur(20px);
        flex-direction: column; align-items: center; justify-content: center;
        gap: 2rem; z-index: 99; }
      .nav-links.open { display: flex; }
      .nav-toggle { display: flex; }
      .about-grid, .benefits-layout { grid-template-columns: 1fr; gap: 3rem; }
      .about-visual { max-height: 280px; }
      .activities-grid { grid-template-columns: 1fr; }
      .plans-grid { grid-template-columns: 1fr; max-width: 400px; margin: 0 auto; }
      section { padding: 5rem 1.25rem; }
      .btn-site { display: none; }
      .vetrina-mosaic {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 200px 160px 160px;
      }
      .mosaic-item.span-col { grid-column: 1 / 3; grid-row: 1; }
      .vetrina-footer-row { flex-direction: column; }
      .vetrina-features { flex-direction: column; gap: 0.6rem; }
    }
    @media (max-width: 600px) {
      .hero-title { font-size: clamp(2.8rem, 12vw, 4rem); }
      .stat-row { grid-template-columns: 1fr; gap: 1rem; }
      .footer-inner { flex-direction: column; text-align: center; }
    }

    /* ── MAIN SITE BUTTON ── */
    .btn-site {
      display: inline-flex; align-items: center; gap: 0.5rem;
      padding: 0.55rem 1.3rem;
      border: 1px solid rgba(201,168,76,0.5);
      color: var(--gold);
      font-family: var(--font-body); font-size: 0.62rem;
      font-weight: 400; letter-spacing: 0.18em; text-transform: uppercase;
      text-decoration: none; cursor: pointer;
      background: transparent;
      transition: all 0.3s var(--ease);
      white-space: nowrap;
    }
    .btn-site:hover {
      background: rgba(201,168,76,0.1);
      border-color: var(--gold);
      box-shadow: 0 4px 20px rgba(201,168,76,0.15);
      transform: translateY(-1px);
    }
    .btn-site svg { width: 12px; height: 12px; stroke: currentColor; fill: none; stroke-width: 2; }

    /* ── VETRINA PREVIEW ── */
    #vetrina-preview { background: var(--black); }
    .vetrina-intro {
      text-align: center; margin-bottom: 4rem;
    }
    .vetrina-intro .section-label { justify-content: center; }
    .vetrina-intro .section-label::before { display: none; }
    .vetrina-mosaic {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr;
      grid-template-rows: 300px 220px;
      gap: 6px; margin-bottom: 3rem;
    }
    .mosaic-item {
      position: relative; overflow: hidden; background: var(--surface);
    }
    .mosaic-item.span-col { grid-row: 1 / 3; }
    .mosaic-item img {
      width: 100%; height: 100%; object-fit: cover;
      transition: transform 0.7s var(--ease), filter 0.5s;
      filter: brightness(0.85) saturate(0.9);
    }
    .mosaic-item:hover img { transform: scale(1.04); filter: brightness(1) saturate(1.1); }
    .mosaic-overlay {
      position: absolute; inset: 0;
      background: linear-gradient(to top, rgba(8,8,8,0.65) 0%, transparent 60%);
      display: flex; align-items: flex-end; padding: 1.2rem;
    }
    .mosaic-label {
      font-size: 0.58rem; letter-spacing: 0.22em; text-transform: uppercase;
      color: var(--gold);
      background: rgba(8,8,8,0.5); padding: 0.3rem 0.7rem;
      border: 1px solid rgba(201,168,76,0.25);
    }
    .vetrina-footer-row {
      display: flex; align-items: center; justify-content: space-between;
      flex-wrap: wrap; gap: 1.5rem;
    }
    .vetrina-features {
      display: flex; gap: 2rem; flex-wrap: wrap;
    }
    .vetrina-feat {
      display: flex; align-items: center; gap: 0.5rem;
      font-size: 0.72rem; color: var(--muted); letter-spacing: 0.1em;
    }
    .vetrina-feat::before {
      content: '◆'; color: var(--gold); font-size: 0.45rem;
    }

    /* ── PLANNING TAG ── */
    .activity-tag.planning {
      color: var(--muted);
      border-color: rgba(136,136,136,0.3);
    }

    /* ── NAV RIGHT (desktop controls) ── */
    .nav-right {
      display: flex; align-items: center; gap: 1rem;
    }

    /* ── SMOOTH MOBILE NAV ── */
    .nav-overlay { display: none; }
    @media (max-width: 900px) {
      .nav-right { display: none; }
      .nav-toggle { display: flex !important; z-index: 101; }
      .nav-overlay {
        display: block; position: fixed; inset: 0;
        background: rgba(8,8,8,0.98);
        backdrop-filter: blur(20px); z-index: 98;
        opacity: 0; pointer-events: none;
        transition: opacity 0.4s;
        padding-top: 80px;
      }
      .nav-overlay.open { opacity: 1; pointer-events: all; }
      .nav-overlay ul {
        display: flex; flex-direction: column;
        align-items: center; justify-content: center;
        height: 100%; gap: 2.5rem; list-style: none;
        padding-bottom: 80px;
      }
      .nav-overlay ul a {
        font-family: var(--font-disp);
        font-size: 2rem; font-weight: 300;
        color: var(--cream); text-decoration: none;
        letter-spacing: 0.05em;
        transition: color 0.3s;
      }
      .nav-overlay ul a:hover { color: var(--gold); }
      .nav-overlay .overlay-lang {
        position: absolute; bottom: 2rem; left: 50%; transform: translateX(-50%);
        display: flex; gap: 0.5rem;
      }
      /* User icon visible on mobile too */
      .nav-user-btn { display: flex !important; }
    }

    /* ── USER ICON IN NAV ── */
    .nav-user-btn {
      display: none;
      align-items: center; justify-content: center;
      width: 34px; height: 34px;
      border: 1px solid var(--gold);
      border-radius: 50%;
      background: rgba(201,168,76,0.08);
      color: var(--gold); cursor: pointer;
      transition: all 0.3s; flex-shrink: 0;
      position: relative;
    }
    .nav-user-btn.active { display: flex; }
    .nav-user-btn:hover { background: rgba(201,168,76,0.18); transform: scale(1.05); }
    .nav-user-btn svg { width: 16px; height: 16px; stroke: currentColor; fill: none; stroke-width: 1.8; }
    .nav-user-dot {
      position: absolute; top: -2px; right: -2px;
      width: 8px; height: 8px;
      background: #4ade80; border-radius: 50%;
      border: 2px solid var(--black);
    }

    /* ── AUTH MODAL ── */
    .lux-overlay {
      position: fixed; inset: 0; z-index: 1000;
      background: rgba(8,8,8,0.85);
      backdrop-filter: blur(16px);
      display: flex; align-items: center; justify-content: center;
      padding: 1rem;
      opacity: 0; pointer-events: none;
      transition: opacity 0.35s;
    }
    .lux-overlay.open { opacity: 1; pointer-events: all; }

    .lux-modal {
      background: var(--surface);
      border: 1px solid var(--border);
      width: 100%; max-width: 460px;
      max-height: 90vh; overflow-y: auto;
      position: relative;
      transform: translateY(20px) scale(0.97);
      transition: transform 0.35s var(--ease), opacity 0.35s;
      opacity: 0;
    }
    .lux-overlay.open .lux-modal {
      transform: translateY(0) scale(1);
      opacity: 1;
    }
    .lux-modal-header {
      padding: 2rem 2rem 0;
      border-bottom: 1px solid var(--border);
      padding-bottom: 1.5rem;
      position: relative;
    }
    .lux-modal-eyebrow {
      font-size: 0.55rem; letter-spacing: 0.3em; text-transform: uppercase;
      color: var(--gold); margin-bottom: 0.5rem;
    }
    .lux-modal-title {
      font-family: var(--font-disp);
      font-size: 1.7rem; font-weight: 300;
      color: var(--cream); line-height: 1.2;
    }
    .lux-modal-close {
      position: absolute; top: 1.5rem; right: 1.5rem;
      background: none; border: none; cursor: pointer;
      color: var(--muted); font-size: 1.3rem;
      line-height: 1; padding: 0.25rem;
      transition: color 0.2s;
    }
    .lux-modal-close:hover { color: var(--gold); }

    .lux-modal-body { padding: 1.75rem 2rem; }

    /* Plan banner inside modal */
    .lux-plan-banner {
      background: rgba(201,168,76,0.06);
      border: 1px solid rgba(201,168,76,0.25);
      padding: 0.9rem 1.2rem;
      margin-bottom: 1.5rem;
      display: flex; align-items: center; gap: 0.75rem;
    }
    .lux-plan-banner-icon { color: var(--gold); font-size: 1.1rem; }
    .lux-plan-banner-text { flex: 1; }
    .lux-plan-banner-name {
      font-family: var(--font-disp);
      font-size: 1rem; font-weight: 400; color: var(--cream);
    }
    .lux-plan-banner-price {
      font-size: 0.72rem; color: var(--gold); margin-top: 0.1rem;
    }

    /* Tabs */
    .lux-tabs {
      display: flex; border-bottom: 1px solid var(--border);
      margin-bottom: 1.5rem;
    }
    .lux-tab {
      flex: 1; padding: 0.7rem; text-align: center;
      font-size: 0.65rem; letter-spacing: 0.18em; text-transform: uppercase;
      color: var(--muted); cursor: pointer; background: none; border: none;
      border-bottom: 2px solid transparent;
      transition: all 0.25s; font-family: var(--font-body);
    }
    .lux-tab.active { color: var(--gold); border-bottom-color: var(--gold); }

    /* Form fields */
    .lux-form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
    @media (max-width: 480px) { .lux-form-row { grid-template-columns: 1fr; } }
    .lux-field { margin-bottom: 1rem; }
    .lux-label {
      display: block; font-size: 0.6rem; letter-spacing: 0.15em; text-transform: uppercase;
      color: var(--muted); margin-bottom: 0.4rem;
    }
    .lux-input {
      width: 100%; background: var(--dark);
      border: 1px solid var(--border);
      color: var(--cream); font-family: var(--font-body);
      font-size: 0.88rem; padding: 0.75rem 1rem;
      outline: none; transition: border-color 0.25s;
      -webkit-appearance: none;
    }
    .lux-input:focus { border-color: var(--gold); }
    .lux-input::placeholder { color: var(--muted); font-size: 0.82rem; }

    /* Password strength */
    .lux-pwd-strength { margin-top: 0.4rem; height: 3px; background: var(--border); }
    .lux-pwd-strength-bar { height: 100%; width: 0; transition: width 0.4s, background 0.4s; }

    /* Submit button */
    .lux-submit {
      width: 100%; padding: 0.95rem;
      background: linear-gradient(135deg, var(--gold-dk), var(--gold), var(--gold-lt));
      color: var(--black); border: none; cursor: pointer;
      font-family: var(--font-body); font-size: 0.68rem;
      font-weight: 500; letter-spacing: 0.2em; text-transform: uppercase;
      transition: opacity 0.3s, transform 0.3s;
      margin-top: 0.5rem;
    }
    .lux-submit:hover { opacity: 0.9; transform: translateY(-1px); }
    .lux-submit:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

    .lux-form-note {
      font-size: 0.7rem; color: var(--muted); text-align: center;
      margin-top: 1rem; line-height: 1.6;
    }
    .lux-form-note a { color: var(--gold); cursor: pointer; }
    .lux-form-note a:hover { text-decoration: underline; }

    .lux-error {
      font-size: 0.72rem; color: #ff6b6b;
      background: rgba(255,107,107,0.08);
      border: 1px solid rgba(255,107,107,0.2);
      padding: 0.6rem 0.9rem; margin-bottom: 1rem;
      display: none;
    }
    .lux-error.show { display: block; }


    /* ── BILLING TOGGLE ── */
    .billing-toggle {
      display: flex; align-items: center; justify-content: center;
      gap: 1rem; margin: 2rem 0 3rem;
    }
    .billing-label {
      font-size: 0.68rem; letter-spacing: 0.18em; text-transform: uppercase;
      color: var(--muted); cursor: pointer; transition: color 0.25s;
      user-select: none;
    }
    .billing-label.active { color: var(--cream); }
    .billing-switch {
      position: relative; width: 48px; height: 26px; cursor: pointer;
    }
    .billing-switch input { display: none; }
    .billing-switch-track {
      position: absolute; inset: 0;
      background: var(--border); border: 1px solid var(--border);
      border-radius: 13px; transition: background 0.3s;
    }
    .billing-switch input:checked ~ .billing-switch-track {
      background: var(--gold-dk); border-color: var(--gold);
    }
    .billing-switch-thumb {
      position: absolute; top: 3px; left: 3px;
      width: 18px; height: 18px; border-radius: 50%;
      background: var(--muted); transition: transform 0.3s, background 0.3s;
    }
    .billing-switch input:checked ~ .billing-switch-thumb {
      transform: translateX(22px); background: var(--gold);
    }
    .billing-save-badge {
      font-size: 0.55rem; letter-spacing: 0.15em; text-transform: uppercase;
      background: rgba(74,222,128,0.12); color: #4ade80;
      border: 1px solid rgba(74,222,128,0.3);
      padding: 0.2rem 0.6rem; white-space: nowrap;
      opacity: 0; transform: translateY(4px);
      transition: opacity 0.3s, transform 0.3s;
      pointer-events: none;
    }
    .billing-save-badge.show { opacity: 1; transform: translateY(0); }
    .plan-price-original {
      font-size: 0.72rem; color: var(--muted);
      text-decoration: line-through; margin-left: 0.4rem;
      align-self: flex-end; margin-bottom: 0.4rem;
      display: none;
    }
    .plan-price-original.show { display: block; }
    .plan-period-note {
      font-size: 0.62rem; color: var(--gold-dk);
      letter-spacing: 0.1em; display: none;
      margin-top: -1rem; margin-bottom: 1rem;
    }
    .plan-period-note.show { display: block; }

    /* ── CANCEL SUBSCRIPTION ── */
    .profile-cancel-zone {
      padding: 1.25rem 2rem;
      border-top: 1px solid var(--border);
    }
    .profile-cancel-btn {
      display: block; width: 100%; text-align: center; padding: 0.7rem;
      background: none; border: 1px solid rgba(255,107,107,0.25);
      color: rgba(255,107,107,0.7); cursor: pointer;
      font-family: var(--font-body); font-size: 0.62rem;
      letter-spacing: 0.18em; text-transform: uppercase;
      transition: all 0.25s;
    }
    .profile-cancel-btn:hover {
      border-color: rgba(255,107,107,0.6); color: #ff6b6b;
      background: rgba(255,107,107,0.06);
    }
    .profile-cancel-confirm {
      display: none; padding: 1rem;
      background: rgba(255,107,107,0.06);
      border: 1px solid rgba(255,107,107,0.2);
      text-align: center;
    }
    .profile-cancel-confirm.show { display: block; }
    .profile-cancel-confirm p {
      font-size: 0.75rem; color: rgba(244,239,230,0.7);
      line-height: 1.6; margin-bottom: 1rem;
    }
    .profile-cancel-confirm-actions {
      display: flex; gap: 0.5rem; justify-content: center;
    }
    .profile-cancel-confirm-actions button {
      padding: 0.5rem 1.2rem;
      font-family: var(--font-body); font-size: 0.62rem;
      letter-spacing: 0.15em; text-transform: uppercase;
      cursor: pointer; border: 1px solid; transition: all 0.25s;
    }
    .btn-cancel-yes {
      background: rgba(255,107,107,0.1); border-color: rgba(255,107,107,0.4);
      color: #ff6b6b;
    }
    .btn-cancel-yes:hover { background: rgba(255,107,107,0.2); }
    .btn-cancel-no {
      background: none; border-color: var(--border); color: var(--muted);
    }
    .btn-cancel-no:hover { border-color: var(--muted); color: var(--cream); }

    /* ── FORGOT PASSWORD ── */
    .lux-success {
      font-size: 0.72rem; color: #4ade80;
      background: rgba(74,222,128,0.08);
      border: 1px solid rgba(74,222,128,0.2);
      padding: 0.6rem 0.9rem; margin-bottom: 1rem;
    }
    .lux-forgot-link {
      display: block; text-align: right;
      font-size: 0.65rem; color: var(--muted);
      cursor: pointer; margin-top: -0.5rem; margin-bottom: 1rem;
      transition: color 0.2s;
    }
    .lux-forgot-link:hover { color: var(--gold); }
    .lux-reset-step { display: none; }
    .lux-reset-step.active { display: block; }
    .lux-otp-inputs {
      display: flex; gap: 0.5rem; justify-content: center; margin-bottom: 1rem;
    }
    .lux-otp-input {
      width: 44px; height: 52px;
      background: var(--dark); border: 1px solid var(--border);
      color: var(--cream); font-family: var(--font-disp);
      font-size: 1.4rem; font-weight: 400;
      text-align: center; outline: none;
      transition: border-color 0.25s;
      -webkit-appearance: none;
    }
    .lux-otp-input:focus { border-color: var(--gold); }
    .lux-back-link {
      display: inline-flex; align-items: center; gap: 0.4rem;
      font-size: 0.65rem; color: var(--muted); cursor: pointer;
      background: none; border: none; padding: 0;
      margin-bottom: 1.25rem; transition: color 0.2s;
    }
    .lux-back-link:hover { color: var(--gold); }
    .lux-stripe-loading {
      text-align: center; padding: 2.5rem;
    }
    .lux-stripe-loading .spinner {
      width: 36px; height: 36px;
      border: 2px solid var(--border);
      border-top-color: var(--gold);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 1rem;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .lux-stripe-loading p {
      font-family: var(--font-disp);
      font-size: 1rem; font-weight: 300;
      color: var(--cream);
    }

    /* ── USER PROFILE POPUP ── */
    .lux-profile-modal {
      background: var(--surface);
      border: 1px solid var(--border);
      width: 100%; max-width: 420px;
    }
    .profile-header {
      background: linear-gradient(135deg, rgba(201,168,76,0.08), rgba(201,168,76,0.03));
      border-bottom: 1px solid var(--border);
      padding: 2rem;
      display: flex; align-items: center; gap: 1.25rem;
    }
    .profile-avatar {
      width: 56px; height: 56px;
      border: 2px solid var(--gold);
      border-radius: 50%;
      background: rgba(201,168,76,0.1);
      display: flex; align-items: center; justify-content: center;
      font-family: var(--font-disp);
      font-size: 1.4rem; font-weight: 400; color: var(--gold);
      flex-shrink: 0;
    }
    .profile-meta .profile-name {
      font-family: var(--font-disp);
      font-size: 1.3rem; font-weight: 300; color: var(--cream);
    }
    .profile-meta .profile-email {
      font-size: 0.72rem; color: var(--muted); margin-top: 0.1rem;
    }
    .profile-section {
      padding: 1.5rem 2rem;
      border-bottom: 1px solid var(--border);
    }
    .profile-section-label {
      font-size: 0.55rem; letter-spacing: 0.3em; text-transform: uppercase;
      color: var(--gold); margin-bottom: 1rem;
    }
    .profile-plan-row {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 0.75rem;
    }
    .profile-plan-row .key {
      font-size: 0.75rem; color: var(--muted);
    }
    .profile-plan-row .value {
      font-size: 0.8rem; color: var(--cream); font-weight: 400;
      text-align: right;
    }
    .profile-badge {
      display: inline-block; font-size: 0.6rem; letter-spacing: 0.15em;
      text-transform: uppercase; padding: 0.2rem 0.6rem;
      border: 1px solid;
    }
    .profile-badge.active { color: #4ade80; border-color: rgba(74,222,128,0.4); background: rgba(74,222,128,0.06); }
    .profile-badge.none { color: var(--muted); border-color: var(--border); }
    .profile-actions { padding: 1.5rem 2rem; display: flex; flex-direction: column; gap: 0.75rem; }
    .profile-renew-btn {
      display: block; text-align: center; padding: 0.8rem;
      background: linear-gradient(135deg, var(--gold-dk), var(--gold));
      color: var(--black); border: none; cursor: pointer;
      font-family: var(--font-body); font-size: 0.65rem;
      font-weight: 500; letter-spacing: 0.2em; text-transform: uppercase;
      transition: opacity 0.3s;
    }
    .profile-renew-btn:hover { opacity: 0.85; }
    .profile-logout-btn {
      display: block; text-align: center; padding: 0.75rem;
      background: none; border: 1px solid rgba(255,255,255,0.1);
      color: var(--muted); cursor: pointer;
      font-family: var(--font-body); font-size: 0.65rem;
      letter-spacing: 0.18em; text-transform: uppercase;
      transition: all 0.25s;
    }
    .profile-logout-btn:hover { border-color: rgba(255,107,107,0.4); color: #ff6b6b; }

    /* ── TOAST ── */
    .lux-toast {
      position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%) translateY(80px);
      background: var(--surface); border: 1px solid var(--border);
      color: var(--cream); padding: 0.9rem 1.5rem;
      font-size: 0.8rem; z-index: 2000;
      transition: transform 0.4s var(--ease), opacity 0.4s;
      opacity: 0; white-space: nowrap; max-width: 90vw;
    }
    .lux-toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
    .lux-toast.success { border-color: rgba(74,222,128,0.4); }
    .lux-toast.error { border-color: rgba(255,107,107,0.4); }

    /* Scrollbar in modal */
    .lux-modal::-webkit-scrollbar { width: 3px; }
    .lux-modal::-webkit-scrollbar-thumb { background: var(--gold-dk); }
  </style>
</head>
<body>

<!-- ░░ NAV ░░ -->
<nav id="navbar">
  <a href="#" class="nav-logo">LuxHaven<span>360</span></a>
  <ul class="nav-links" id="navLinks">
    <li><a href="#about"            data-i18n="nav.about">Chi Siamo</a></li>
    <li><a href="#activities"       data-i18n="nav.activities">Servizi</a></li>
    <li><a href="#vetrina-preview"  data-i18n="nav.showcase">Vetrina</a></li>
    <li><a href="#benefits"         data-i18n="nav.benefits">Vantaggi</a></li>
    <li><a href="#subscriptions"    data-i18n="nav.plans">Abbonamenti</a></li>
  </ul>
  <div class="nav-right">
    <a href="https://luxhaven360.github.io/luxhaven360-site/" target="_blank" class="btn-site" data-i18n="nav.mainsite">
      <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
      Sito Principale
    </a>
    <div class="lang-switcher" id="langSwitcher">
      <button class="lang-btn active" data-lang="it">IT</button>
      <button class="lang-btn" data-lang="en">EN</button>
      <button class="lang-btn" data-lang="fr">FR</button>
      <button class="lang-btn" data-lang="de">DE</button>
      <button class="lang-btn" data-lang="es">ES</button>
    </div>
  </div>
  <!-- User icon (shown when logged in) -->
  <button class="nav-user-btn" id="navUserBtn" onclick="openProfileModal()" aria-label="Profilo utente" title="Profilo">
    <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
    <span class="nav-user-dot"></span>
  </button>
  <div class="nav-toggle" id="navToggle">
    <span></span><span></span><span></span>
  </div>
</nav>

<!-- Mobile overlay nav -->
<div class="nav-overlay" id="navOverlay">
  <ul>
    <li><a href="#about"            data-i18n="nav.about">Chi Siamo</a></li>
    <li><a href="#activities"       data-i18n="nav.activities">Servizi</a></li>
    <li><a href="#vetrina-preview"  data-i18n="nav.showcase">Vetrina</a></li>
    <li><a href="#benefits"         data-i18n="nav.benefits">Vantaggi</a></li>
    <li><a href="#subscriptions"    data-i18n="nav.plans">Abbonamenti</a></li>
    <li><a href="https://luxhaven360.github.io/luxhaven360-site/" target="_blank" data-i18n="nav.mainsite">Sito Principale</a></li>
  </ul>
  <div class="overlay-lang">
    <button class="lang-btn active" data-lang="it">IT</button>
    <button class="lang-btn" data-lang="en">EN</button>
    <button class="lang-btn" data-lang="fr">FR</button>
    <button class="lang-btn" data-lang="de">DE</button>
    <button class="lang-btn" data-lang="es">ES</button>
  </div>
</div>

<!-- ░░ HERO ░░ -->
<section id="hero">
  <div class="hero-bg"></div>
  <div class="hero-lines"></div>
  <div class="hero-content">
    <p class="hero-eyebrow" data-i18n="hero.eyebrow">Eccellenza Senza Compromessi</p>
    <h1 class="hero-title">LuxHaven<em>360</em></h1>
    <p class="hero-tagline" data-i18n="hero.tagline">Il mondo che merita la tua attenzione</p>
    <p class="hero-desc" data-i18n="hero.desc">
      Una piattaforma esclusiva dedicata a proprietà di prestigio, veicoli straordinari e beni selezionati. Non semplice commercio: un'esperienza per chi non accetta compromessi.
    </p>
    <div class="hero-cta">
      <a href="#about" class="btn-primary" data-i18n="hero.cta1">Scopri la piattaforma</a>
      <a href="#subscriptions" class="btn-outline" data-i18n="hero.cta2">Piani & Abbonamenti</a>
    </div>
  </div>
</section>

<div class="divider"></div>

<!-- ░░ ABOUT ░░ -->
<section id="about">
  <div class="container">
    <div class="about-grid">
      <div>
        <p class="section-label reveal" data-i18n="about.label">Chi Siamo</p>
        <h2 class="section-title reveal reveal-delay-1" data-i18n="about.title">Un progetto digitale<br><em>senza precedenti</em></h2>
        <p class="section-body reveal reveal-delay-2" data-i18n="about.body">
          LuxHaven360 nasce con l'ambizione di diventare il punto di riferimento per la vendita, la promozione e l'intermediazione di proprietà di prestigio, supercar e beni selezionati. Non una vetrina qualunque: un ecosistema digitale che unisce contenuti raffinati, servizi esclusivi ed esperienze uniche.
        </p>
        <div class="about-pillars reveal reveal-delay-3">
          <div class="pillar">
            <div class="pillar-icon">◆</div>
            <div class="pillar-text">
              <h4 data-i18n="pillar1.title">Proprietà di Prestigio</h4>
              <p data-i18n="pillar1.body">Ville, castelli, residenze storiche e dimore di rara bellezza.</p>
            </div>
          </div>
          <div class="pillar">
            <div class="pillar-icon">◆</div>
            <div class="pillar-text">
              <h4 data-i18n="pillar2.title">Veicoli Esclusivi</h4>
              <p data-i18n="pillar2.body">Supercar, hypercar e automobili d'eccezione selezionate con cura.</p>
            </div>
          </div>
          <div class="pillar">
            <div class="pillar-icon">◆</div>
            <div class="pillar-text">
              <h4 data-i18n="pillar3.title">Beni Selezionati</h4>
              <p data-i18n="pillar3.body">Oggetti, esperienze e prodotti brandizzati per una community esclusiva.</p>
            </div>
          </div>
        </div>
      </div>
      <div class="about-visual reveal reveal-delay-2">
        <div class="about-card">
          <div class="about-card-number">360</div>
          <p class="about-card-label" data-i18n="aboutcard.label">La nostra missione</p>
          <h3 class="about-card-title" data-i18n="aboutcard.title">Oltre la semplice<br>compravendita.</h3>
        </div>
      </div>
    </div>
  </div>
</section>

<div class="divider"></div>

<!-- ░░ ACTIVITIES ░░ -->
<section id="activities">
  <div class="container">
    <div class="activities-header">
      <div>
        <p class="section-label reveal" data-i18n="act.label">La Piattaforma</p>
        <h2 class="section-title reveal reveal-delay-1" data-i18n="act.title">Tutto ciò che<br><em>offriamo</em></h2>
      </div>
      <p class="section-body reveal reveal-delay-2" style="max-width:340px" data-i18n="act.subtitle">
        Un ecosistema in evoluzione costante, progettato attorno alle esigenze di chi non si accontenta.
      </p>
    </div>
    <div class="activities-grid reveal">
      <div class="activity-card">
        <div class="activity-num">01</div>
        <h3 class="activity-title" data-i18n="a1.title">Vetrina & Promozione</h3>
        <p class="activity-desc" data-i18n="a1.desc">Showcase fotografici e video immersivi, schede dettagliate con gallerie, planimetrie e contenuti editoriali che raccontano la storia di ogni proprietà e veicolo.</p>
        <span class="activity-tag" data-i18n="a1.tag">Fase attiva</span>
      </div>
      <div class="activity-card">
        <div class="activity-num">02</div>
        <h3 class="activity-title" data-i18n="a2.title">Listing & Intermediazione</h3>
        <p class="activity-desc" data-i18n="a2.desc">Annunci di vendita e soggiorni a breve e medio termine. Supporto per visite in loco, due diligence e gestione completa delle trattative.</p>
        <span class="activity-tag" data-i18n="a2.tag">In arrivo</span>
      </div>
      <div class="activity-card">
        <div class="activity-num">03</div>
        <h3 class="activity-title" data-i18n="a3.title">Esperienze & Stays</h3>
        <p class="activity-desc" data-i18n="a3.desc">Pacchetti esperienziali dedicati: soggiorni in ville e castelli selezionati, itinerari culturali e weekend d'eccezione. I test drive in supercar sono disponibili nella sezione Supercar e potranno essere inclusi in future proposte esperienziali.</p>
        <span class="activity-tag" data-i18n="a3.tag">In arrivo</span>
      </div>
      <div class="activity-card">
        <div class="activity-num">04</div>
        <h3 class="activity-title" data-i18n="a4.title">Merchandising Ufficiale</h3>
        <p class="activity-desc" data-i18n="a4.desc">Prodotti brandizzati LuxHaven360: ogni acquisto è un punto di contatto con un universo di riferimento, non un semplice acquisto commerciale.</p>
        <span class="activity-tag" data-i18n="a4.tag">Disponibile</span>
      </div>
      <div class="activity-card">
        <div class="activity-num">05</div>
        <h3 class="activity-title" data-i18n="a5.title">Comunicazione & PR</h3>
        <p class="activity-desc" data-i18n="a5.desc">Collaborazioni con influencer e conciergerie di rango. Advertising mirato, eventi esclusivi e accesso a iniziative riservate alla community.</p>
        <span class="activity-tag planning" data-i18n="a5.tag">In pianificazione</span>
      </div>
      <div class="activity-card" style="display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;gap:1rem;">
        <p class="section-label" style="justify-content:center;" data-i18n="actmore.label">E molto altro</p>
        <p style="font-family:var(--font-disp);font-size:1.3rem;font-weight:300;color:var(--cream);" data-i18n="actmore.text">La piattaforma è in continua espansione.</p>
        <a href="#subscriptions" class="btn-outline" data-i18n="actmore.cta">Unisciti ora</a>
      </div>
    </div>
  </div>
</section>

<div class="divider"></div>

<!-- ░░ VETRINA & PROMOZIONE PREVIEW ░░ -->
<section id="vetrina-preview">
  <div class="container">
    <div class="vetrina-intro reveal">
      <p class="section-label" data-i18n="vetrina.label">Vetrina & Promozione</p>
      <h2 class="section-title reveal reveal-delay-1" data-i18n="vetrina.title">Ogni proprietà,<br><em>una storia da raccontare</em></h2>
      <p class="section-body reveal reveal-delay-2" style="margin:0 auto 2.5rem;" data-i18n="vetrina.subtitle">
        Showcase fotografici e video immersivi, schede dettagliate con gallerie e planimetrie, contenuti editoriali curati che valorizzano ogni dettaglio di ogni proprietà e veicolo.
      </p>
    </div>

    <!-- Mosaic gallery -->
    <div class="vetrina-mosaic reveal reveal-delay-1">
      <!-- Main large image -->
      <div class="mosaic-item span-col">
        <img
          src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=900&q=85&fit=crop"
          alt="Villa di lusso con piscina"
          loading="lazy"
        />
        <div class="mosaic-overlay">
          <span class="mosaic-label" data-i18n="vetrina.tag.villa">Villa Esclusiva · Toscana</span>
        </div>
      </div>
      <!-- Top right -->
      <div class="mosaic-item">
        <img
          src="https://images.unsplash.com/photo-1544636331-e26879cd4d9b?w=600&q=85&fit=crop"
          alt="Supercar rossa di lusso"
          loading="lazy"
        />
        <div class="mosaic-overlay">
          <span class="mosaic-label" data-i18n="vetrina.tag.supercar">Supercar · Limited Edition</span>
        </div>
      </div>
      <!-- Top far right -->
      <div class="mosaic-item">
        <img
          src="https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=600&q=85&fit=crop"
          alt="Dimora di pregio moderna"
          loading="lazy"
        />
        <div class="mosaic-overlay">
          <span class="mosaic-label" data-i18n="vetrina.tag.estate">Residenza · Côte d'Azur</span>
        </div>
      </div>
      <!-- Bottom right -->
      <div class="mosaic-item">
        <img
          src="https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=600&q=85&fit=crop"
          alt="Villa moderna con giardino"
          loading="lazy"
        />
        <div class="mosaic-overlay">
          <span class="mosaic-label" data-i18n="vetrina.tag.villa2">Villa · Lake Como</span>
        </div>
      </div>
      <!-- Bottom far right -->
      <div class="mosaic-item">
        <img
          src="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=600&q=85&fit=crop"
          alt="Auto sportiva di lusso"
          loading="lazy"
        />
        <div class="mosaic-overlay">
          <span class="mosaic-label" data-i18n="vetrina.tag.car2">Hypercar · Esclusivo</span>
        </div>
      </div>
    </div>

    <div class="vetrina-footer-row reveal reveal-delay-2">
      <div class="vetrina-features">
        <span class="vetrina-feat" data-i18n="vetrina.feat1">Showcase fotografici ad alta risoluzione</span>
        <span class="vetrina-feat" data-i18n="vetrina.feat2">Video immersivi e tour virtuali</span>
        <span class="vetrina-feat" data-i18n="vetrina.feat3">Gallerie & Planimetrie dettagliate</span>
        <span class="vetrina-feat" data-i18n="vetrina.feat4">Contenuti editoriali esclusivi</span>
      </div>
      <a href="https://luxhaven360.github.io/luxhaven360-site/luxhaven360/showcase" target="_blank" class="btn-primary" data-i18n="vetrina.cta">
        Esplora la Vetrina Completa
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
      </a>
    </div>
  </div>
</section>

<div class="divider"></div>

<!-- ░░ BENEFITS ░░ -->
<section id="benefits">
  <div class="container">
    <div class="benefits-layout">
      <div>
        <p class="section-label reveal" data-i18n="ben.label">Perché LuxHaven360</p>
        <h2 class="section-title reveal reveal-delay-1" data-i18n="ben.title">I vantaggi<br><em>concreti</em></h2>
        <div class="benefits-list">
          <div class="benefit-item reveal">
            <span class="benefit-num">01</span>
            <div class="benefit-content">
              <h4 data-i18n="b1.title">Selezione Rigorosa</h4>
              <p data-i18n="b1.body">Ogni proprietà, veicolo e bene è curato e verificato. Nessun contenuto generico: solo ciò che merita davvero attenzione.</p>
            </div>
          </div>
          <div class="benefit-item reveal reveal-delay-1">
            <span class="benefit-num">02</span>
            <div class="benefit-content">
              <h4 data-i18n="b2.title">Accesso Anticipato</h4>
              <p data-i18n="b2.body">Gli utenti della community ricevono accesso priority a nuovi listing, limited drops e opportunità esclusive prima di chiunque altro.</p>
            </div>
          </div>
          <div class="benefit-item reveal reveal-delay-2">
            <span class="benefit-num">03</span>
            <div class="benefit-content">
              <h4 data-i18n="b3.title">Esperienze Riservate</h4>
              <p data-i18n="b3.body">Inviti a eventi selezionati, soggiorni in dimore d'eccezione e iniziative speciali pensate per chi fa parte della community.</p>
            </div>
          </div>
          <div class="benefit-item reveal reveal-delay-3">
            <span class="benefit-num">04</span>
            <div class="benefit-content">
              <h4 data-i18n="b4.title">Community Esclusiva</h4>
              <p data-i18n="b4.body">Non una semplice piattaforma: una rete di persone con gusti raffinati, valori condivisi e aspirazioni autentiche.</p>
            </div>
          </div>
        </div>
      </div>
      <div class="benefits-right reveal reveal-delay-2">
        <div class="benefits-visual">
          <div class="stat-row">
            <div class="stat">
              <div class="stat-num">360°</div>
              <div class="stat-label" data-i18n="stat1">Visione Completa</div>
            </div>
            <div class="stat">
              <div class="stat-num" data-i18n="stat2n">Zero</div>
              <div class="stat-label" data-i18n="stat2">Compromessi</div>
            </div>
          </div>
          <div class="quote-block">
            <p data-i18n="quote">"Ogni dettaglio è curato perché l'eccellenza non è un'opzione — è l'unico standard che accettiamo."</p>
            <cite>LuxHaven360</cite>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<div class="divider"></div>

<!-- ░░ SUBSCRIPTIONS ░░ -->
<section id="subscriptions">
  <div class="container">
    <div class="plans-header">
      <p class="section-label reveal" data-i18n="plans.label">Abbonamenti</p>
      <h2 class="section-title reveal reveal-delay-1" data-i18n="plans.title">Scegli il tuo<br><em>livello di accesso</em></h2>
      <p class="section-body reveal reveal-delay-2" data-i18n="plans.subtitle">
        I proventi degli abbonamenti supportano l'infrastruttura della piattaforma e finanziano vantaggi concreti per gli iscritti. Ogni piano è progettato per offrire un ritorno reale.
      </p>
    </div>
      <!-- BILLING TOGGLE -->
      <div class="billing-toggle reveal">
        <span class="billing-label active" id="lblMonthly" data-i18n="plans.billing.monthly" onclick="setBilling('monthly')">Mensile</span>
        <label class="billing-switch" aria-label="Fatturazione annuale">
          <input type="checkbox" id="billingToggle" onchange="setBilling(this.checked?'annual':'monthly')">
          <span class="billing-switch-track"></span>
          <span class="billing-switch-thumb"></span>
        </label>
        <span class="billing-label" id="lblAnnual" data-i18n="plans.billing.annual" onclick="setBilling('annual')">Annuale</span>
        <span class="billing-save-badge" id="saveBadge" data-i18n="plans.billing.save">Risparmia 20%</span>
      </div>

    <div class="plans-grid">

      <!-- EXPLORER -->
      <div class="plan-card reveal">
        <p class="plan-tier" data-i18n="p1.tier">Explorer</p>
        <h3 class="plan-name" data-i18n="p1.name">Accesso</h3>
        <p class="plan-desc" data-i18n="p1.desc">Il punto di partenza per scoprire l'universo LuxHaven360 e accedere ai contenuti della piattaforma.</p>
        <div class="plan-price">
          <span class="currency" id="currency-1">€</span>
          <span class="amount" id="amount-1" data-eur="4" data-eur-annual="39">4</span>
          <span class="period" id="period-1" data-i18n="permonth">/ mese</span>
          <span class="plan-price-original" id="original-1"></span>
        </div>
        <p class="plan-period-note" id="note-1" data-i18n="plans.billing.billed_annual">Fatturato €39 / anno</p>
        <ul class="plan-features">
          <li data-i18n="p1f1">Accesso completo alla vetrina immobili e veicoli</li>
          <li data-i18n="p1f2">Newsletter mensile con contenuti esclusivi</li>
          <li data-i18n="p1f3">Sconto 5% sul merchandising ufficiale</li>
          <li data-i18n="p1f4">Partecipazione alla community base</li>
          <li class="dim" data-i18n="p1f5">Accesso anticipato ai listing</li>
          <li class="dim" data-i18n="p1f6">Inviti a eventi esclusivi</li>
        </ul>
        <button class="plan-cta" data-i18n="plan.cta.start" onclick="handlePlanClick('explorer','p1')">Inizia ora</button>
      </div>

      <!-- PRESTIGE -->
      <div class="plan-card featured reveal reveal-delay-1">
        <span class="plan-badge" data-i18n="badge.popular">Più Scelto</span>
        <p class="plan-tier" data-i18n="p2.tier">Prestige</p>
        <h3 class="plan-name" data-i18n="p2.name">Privilegio</h3>
        <p class="plan-desc" data-i18n="p2.desc">Per chi vuole essere tra i primi a scoprire nuove opportunità e vivere l'esperienza LuxHaven360 appieno.</p>
        <div class="plan-price">
          <span class="currency" id="currency-2">€</span>
          <span class="amount" id="amount-2" data-eur="12" data-eur-annual="115">12</span>
          <span class="period" id="period-2" data-i18n="permonth">/ mese</span>
          <span class="plan-price-original" id="original-2"></span>
        </div>
        <p class="plan-period-note" id="note-2" data-i18n="plans.billing.billed_annual_prestige">Fatturato €115 / anno</p>
        <ul class="plan-features">
          <li data-i18n="p2f1">Tutto del piano Explorer</li>
          <li data-i18n="p2f2">Accesso anticipato a nuovi listing e drop</li>
          <li data-i18n="p2f3">Sconto 15% sul merchandising ufficiale</li>
          <li data-i18n="p2f4">Newsletter settimanale dedicata</li>
          <li data-i18n="p2f5">Badge verificato nella community</li>
          <li data-i18n="p2f6">Inviti prioritari a eventi selezionati</li>
        </ul>
        <button class="plan-cta" data-i18n="plan.cta.join" onclick="handlePlanClick('prestige','p2')">Entra nel club</button>
      </div>

      <!-- ELITE -->
      <div class="plan-card reveal reveal-delay-2">
        <p class="plan-tier" data-i18n="p3.tier">Élite</p>
        <h3 class="plan-name" data-i18n="p3.name">Sovranità</h3>
        <p class="plan-desc" data-i18n="p3.desc">L'accesso definitivo. Per chi non vuole confini e pretende il massimo da ogni interazione con LuxHaven360.</p>
        <div class="plan-price">
          <span class="currency" id="currency-3">€</span>
          <span class="amount" id="amount-3" data-eur="29" data-eur-annual="278">29</span>
          <span class="period" id="period-3" data-i18n="permonth">/ mese</span>
          <span class="plan-price-original" id="original-3"></span>
        </div>
        <p class="plan-period-note" id="note-3" data-i18n="plans.billing.billed_annual_elite">Fatturato €278 / anno</p>
        <ul class="plan-features">
          <li data-i18n="p3f1">Tutto del piano Prestige</li>
          <li data-i18n="p3f2">Accesso esclusivo a listing riservati</li>
          <li data-i18n="p3f3">Sconto 25% + prodotti limited edition</li>
          <li data-i18n="p3f4">Consulenza personalizzata dedicata</li>
          <li data-i18n="p3f5">Inviti a esperienze fisiche (soggiorni, eventi)</li>
          <li data-i18n="p3f6">Riconoscimento Fondatore nella community</li>
        </ul>
        <button class="plan-cta" data-i18n="plan.cta.elite" onclick="handlePlanClick('elite','p3')">Diventa Élite</button>
      </div>

    </div>
    <p class="plans-note reveal">
      <span data-i18n="plans.note1">I proventi degli abbonamenti coprono i costi di gestione del servizio</span> — <span data-i18n="plans.note2">incluse le infrastrutture operative della piattaforma — e finanziano i vantaggi offerti agli iscritti.</span>
    </p>
  </div>
</section>

<div class="divider"></div>

<!-- ░░ COMMUNITY CTA ░░ -->
<section id="community">
  <div class="container">
    <div class="community-inner">
      <p class="community-ornament" aria-hidden="true">LH360</p>
      <p class="section-label reveal" data-i18n="comm.label">La Community</p>
      <h2 class="section-title reveal reveal-delay-1" data-i18n="comm.title">Non un negozio.<br><em>Un universo.</em></h2>
      <p class="section-body reveal reveal-delay-2" data-i18n="comm.body">
        LuxHaven360 è un'esperienza. Chi entra a far parte di questa realtà non è semplicemente un cliente: è parte di qualcosa di più grande. Una community selezionata, un brand che definisce uno stile di vita senza compromessi.
      </p>
      <div class="reveal reveal-delay-3" style="display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;margin-top:2rem;">
        <a href="#subscriptions" class="btn-primary" data-i18n="comm.cta1">Unisciti alla community</a>
        <a href="/cdn-cgi/l/email-protection#9cf5f2faf3dcf0e9e4f4fdeaf9f2afaaacb2fff3f1" class="btn-outline" data-i18n="comm.cta2">Contattaci</a>
      </div>
    </div>
  </div>
</section>

<!-- ░░ FOOTER ░░ -->
<footer>
  <div class="footer-inner">
    <div>
      <div class="footer-logo">LuxHaven<span>360</span></div>
      <div class="footer-tagline" data-i18n="footer.tagline">Eccellenza Senza Compromessi</div>
    </div>
    <p class="footer-copy" id="footer-copy" data-i18n="footer.copy">© 2025 LuxHaven360. Tutti i diritti riservati.</p>
  </div>
</footer>

<!-- ░░ AUTH MODAL ░░ -->
<div class="lux-overlay" id="authOverlay" role="dialog" aria-modal="true" aria-labelledby="authTitle">
  <div class="lux-modal" id="authModal">
    <div class="lux-modal-header">
      <p class="lux-modal-eyebrow">LuxHaven<span style="color:var(--gold)">360</span></p>
      <h2 class="lux-modal-title" id="authTitle" data-i18n="auth.register.title">Crea il tuo account</h2>
      <button class="lux-modal-close" onclick="closeAuthModal()" aria-label="Chiudi">&#x2715;</button>
    </div>
    <div class="lux-modal-body">
      <!-- Plan banner -->
      <div class="lux-plan-banner" id="authPlanBanner">
        <span class="lux-plan-banner-icon">◆</span>
        <div class="lux-plan-banner-text">
          <div class="lux-plan-banner-name" id="authPlanName">Explorer</div>
          <div class="lux-plan-banner-price" id="authPlanPrice">€4 / mese</div>
        </div>
      </div>
      <!-- Tabs -->
      <div class="lux-tabs" id="authTabs">
        <button class="lux-tab active" id="tabRegister" onclick="switchTab('register')" data-i18n="auth.tab.register">Registrati</button>
        <button class="lux-tab" id="tabLogin" onclick="switchTab('login')" data-i18n="auth.tab.login">Accedi</button>
      </div>
      <!-- Error -->
      <div class="lux-error" id="authError"></div>

      <!-- REGISTER FORM -->
      <div id="formRegister">
        <div class="lux-form-row">
          <div class="lux-field">
            <label class="lux-label" data-i18n="auth.firstname">Nome</label>
            <input class="lux-input" type="text" id="regFirstName" autocomplete="given-name" required>
          </div>
          <div class="lux-field">
            <label class="lux-label" data-i18n="auth.lastname">Cognome</label>
            <input class="lux-input" type="text" id="regLastName" autocomplete="family-name" required>
          </div>
        </div>
        <div class="lux-field">
          <label class="lux-label" data-i18n="auth.email">Email</label>
          <input class="lux-input" type="email" id="regEmail" autocomplete="email" required>
        </div>
        <div class="lux-field">
          <label class="lux-label" data-i18n="auth.password">Password</label>
          <input class="lux-input" type="password" id="regPassword" autocomplete="new-password" oninput="checkPwdStrength(this.value)" required>
          <div class="lux-pwd-strength"><div class="lux-pwd-strength-bar" id="pwdBar"></div></div>
        </div>
        <div class="lux-field">
          <label class="lux-label" data-i18n="auth.confirm_password">Conferma Password</label>
          <input class="lux-input" type="password" id="regPasswordConfirm" autocomplete="new-password" required>
        </div>
        <button class="lux-submit" id="btnRegister" onclick="handleRegister()" data-i18n="auth.register.btn">Crea account e procedi al pagamento</button>
        <p class="lux-form-note" data-i18n="auth.register.note">Hai già un account? <a onclick="switchTab('login')">Accedi</a></p>
      </div>

      <!-- LOGIN FORM -->
      <div id="formLogin" style="display:none;">
        <div class="lux-field">
          <label class="lux-label" data-i18n="auth.email">Email</label>
          <input class="lux-input" type="email" id="loginEmail" autocomplete="email" required>
        </div>
        <div class="lux-field">
          <label class="lux-label" data-i18n="auth.password">Password</label>
          <input class="lux-input" type="password" id="loginPassword" autocomplete="current-password" required>
        </div>
        <span class="lux-forgot-link" onclick="openForgotPassword()" data-i18n="auth.forgot.link">Password dimenticata?</span>
        <button class="lux-submit" id="btnLogin" onclick="handleLogin()" data-i18n="auth.login.btn">Accedi e procedi al pagamento</button>
        <p class="lux-form-note" data-i18n="auth.login.note">Non hai un account? <a onclick="switchTab('register')">Registrati</a></p>
      </div>

      <!-- FORGOT PASSWORD FORM -->
      <div id="formForgotPwd" style="display:none;">

        <!-- Step 1: email -->
        <div class="lux-reset-step active" id="resetStep1">
          <button class="lux-back-link" onclick="closeForgotPassword()">
            &#8592; <span data-i18n="auth.forgot.back">Torna al login</span>
          </button>
          <div class="lux-field">
            <label class="lux-label" data-i18n="auth.email">Email</label>
            <input class="lux-input" type="email" id="resetEmail" autocomplete="email" required>
          </div>
          <button class="lux-submit" id="btnSendReset" onclick="handleSendReset()" data-i18n="auth.forgot.send">Invia codice di verifica</button>
        </div>

        <!-- Step 2: OTP + new password -->
        <div class="lux-reset-step" id="resetStep2">
          <button class="lux-back-link" onclick="goToResetStep(1)">
            &#8592; <span data-i18n="auth.forgot.back_step1">Modifica email</span>
          </button>
          <p style="font-size:0.78rem;color:var(--muted);margin-bottom:1.2rem;" data-i18n="auth.forgot.step2_hint">Inserisci il codice a 6 cifre ricevuto via email.</p>
          <div class="lux-otp-inputs" id="otpInputs">
            <input class="lux-otp-input" type="text" maxlength="1" inputmode="numeric" oninput="otpNext(this,0)">
            <input class="lux-otp-input" type="text" maxlength="1" inputmode="numeric" oninput="otpNext(this,1)">
            <input class="lux-otp-input" type="text" maxlength="1" inputmode="numeric" oninput="otpNext(this,2)">
            <input class="lux-otp-input" type="text" maxlength="1" inputmode="numeric" oninput="otpNext(this,3)">
            <input class="lux-otp-input" type="text" maxlength="1" inputmode="numeric" oninput="otpNext(this,4)">
            <input class="lux-otp-input" type="text" maxlength="1" inputmode="numeric" oninput="otpNext(this,5)">
          </div>
          <div class="lux-field">
            <label class="lux-label" data-i18n="auth.forgot.new_pwd">Nuova password</label>
            <input class="lux-input" type="password" id="resetNewPwd" autocomplete="new-password" oninput="checkPwdStrength(this.value)" required>
            <div class="lux-pwd-strength"><div class="lux-pwd-strength-bar" id="resetPwdBar"></div></div>
          </div>
          <div class="lux-field">
            <label class="lux-label" data-i18n="auth.confirm_password">Conferma Password</label>
            <input class="lux-input" type="password" id="resetConfirmPwd" autocomplete="new-password" required>
          </div>
          <button class="lux-submit" id="btnConfirmReset" onclick="handleConfirmReset()" data-i18n="auth.forgot.confirm">Imposta nuova password</button>
          <p class="lux-form-note" style="margin-top:0.75rem;">
            <a onclick="handleSendReset(true)" data-i18n="auth.forgot.resend">Non hai ricevuto il codice? Invia di nuovo</a>
          </p>
        </div>

      </div>

      <!-- Stripe Loading -->
      <div class="lux-stripe-loading" id="stripeLoading" style="display:none;">
        <div class="spinner"></div>
        <p data-i18n="auth.redirecting">Reindirizzamento a Stripe...</p>
      </div>
    </div>
  </div>
</div>

<!-- ░░ PROFILE MODAL ░░ -->
<div class="lux-overlay" id="profileOverlay" role="dialog" aria-modal="true">
  <div class="lux-modal lux-profile-modal" id="profileModal">
    <button class="lux-modal-close" onclick="closeProfileModal()" aria-label="Chiudi" style="top:1rem;right:1rem;">&#x2715;</button>
    <div class="profile-header">
      <div class="profile-avatar" id="profileAvatar">L</div>
      <div class="profile-meta">
        <div class="profile-name" id="profileName">—</div>
        <div class="profile-email" id="profileEmail">—</div>
      </div>
    </div>
    <div class="profile-section" id="profileSubSection">
      <div class="profile-section-label" data-i18n="profile.subscription">Abbonamento</div>
      <div class="profile-plan-row">
        <span class="key" data-i18n="profile.plan">Piano</span>
        <span class="value" id="profilePlan">—</span>
      </div>
      <div class="profile-plan-row">
        <span class="key" data-i18n="profile.status">Stato</span>
        <span class="value"><span class="profile-badge none" id="profileStatus">—</span></span>
      </div>
      <div class="profile-plan-row" id="profileStartRow">
        <span class="key" data-i18n="profile.start">Data inizio</span>
        <span class="value" id="profileStart">—</span>
      </div>
      <div class="profile-plan-row" id="profileExpireRow">
        <span class="key" data-i18n="profile.expires">Scadenza</span>
        <span class="value" id="profileExpire">—</span>
      </div>
      <div class="profile-plan-row" id="profileBillingRow">
        <span class="key" data-i18n="profile.billing_period">Tipo abbonamento</span>
        <span class="value" id="profileBilling">—</span>
      </div>
      <div class="profile-plan-row" id="profileRenewRow">
        <span class="key" data-i18n="profile.autorenew">Rinnovo automatico</span>
        <span class="value" id="profileRenew">—</span>
      </div>
    </div>
    <div class="profile-actions">
      <button class="profile-renew-btn" id="profileRenewBtn" onclick="handleUpgrade()" data-i18n="profile.renew_btn">Rinnova / Cambia piano</button>
      <button class="profile-logout-btn" onclick="handleLogout()" data-i18n="profile.logout">Esci dall'account</button>
    </div>
    <!-- Cancel subscription zone (shown only if active sub) -->
    <div class="profile-cancel-zone" id="profileCancelZone" style="display:none;">
      <button class="profile-cancel-btn" id="profileCancelBtn" onclick="showCancelConfirm()" data-i18n="profile.cancel_btn">Termina abbonamento</button>
      <div class="profile-cancel-confirm" id="cancelConfirmBox">
        <p id="cancelConfirmMsg" data-i18n="profile.cancel_confirm">Sei sicuro? Il tuo abbonamento rimarrà attivo fino alla data di scadenza e non verrà rinnovato.</p>
        <div class="profile-cancel-confirm-actions">
          <button class="btn-cancel-yes" onclick="handleCancelSubscription()" data-i18n="profile.cancel_yes">Sì, termina</button>
          <button class="btn-cancel-no" onclick="hideCancelConfirm()" data-i18n="profile.cancel_no">Annulla</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ░░ TOAST ░░ -->
<div class="lux-toast" id="luxToast"></div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  /* ═══════════════════════════════════════════
     TRANSLATIONS
  ═══════════════════════════════════════════ */
  const i18n = {
    it: {
      "nav.about": "Chi Siamo",
      "nav.activities": "Servizi",
      "nav.showcase": "Vetrina",
      "nav.benefits": "Vantaggi",
      "nav.plans": "Abbonamenti",
      "nav.mainsite": "Sito Principale",
      "hero.eyebrow": "Eccellenza Senza Compromessi",
      "hero.tagline": "Il mondo che merita la tua attenzione",
      "hero.desc": "Una piattaforma esclusiva dedicata a proprietà di prestigio, veicoli straordinari e beni selezionati. Non semplice commercio: un'esperienza per chi non accetta compromessi.",
      "hero.cta1": "Scopri la piattaforma",
      "hero.cta2": "Piani & Abbonamenti",
      "about.label": "Chi Siamo",
      "about.title": "Un progetto digitale<br><em>senza precedenti</em>",
      "about.body": "LuxHaven360 nasce con l'ambizione di diventare il punto di riferimento per la vendita, la promozione e l'intermediazione di proprietà di prestigio, supercar e beni selezionati. Non una vetrina qualunque: un ecosistema digitale che unisce contenuti raffinati, servizi esclusivi ed esperienze uniche.",
      "pillar1.title": "Proprietà di Prestigio",
      "pillar1.body": "Ville, castelli, residenze storiche e dimore di rara bellezza.",
      "pillar2.title": "Veicoli Esclusivi",
      "pillar2.body": "Supercar, hypercar e automobili d'eccezione selezionate con cura.",
      "pillar3.title": "Beni Selezionati",
      "pillar3.body": "Oggetti, esperienze e prodotti brandizzati per una community esclusiva.",
      "aboutcard.label": "La nostra missione",
      "aboutcard.title": "Oltre la semplice<br>compravendita.",
      "act.label": "La Piattaforma",
      "act.title": "Tutto ciò che<br><em>offriamo</em>",
      "act.subtitle": "Un ecosistema in evoluzione costante, progettato attorno alle esigenze di chi non si accontenta.",
      "a1.title": "Vetrina & Promozione",
      "a1.desc": "Showcase fotografici e video immersivi, schede dettagliate con gallerie, planimetrie e contenuti editoriali che raccontano la storia di ogni proprietà e veicolo.",
      "a1.tag": "Fase attiva",
      "a2.title": "Listing & Intermediazione",
      "a2.desc": "Annunci di vendita e soggiorni a breve e medio termine. Supporto per visite in loco, due diligence e gestione completa delle trattative.",
      "a2.tag": "In arrivo",
      "a3.title": "Esperienze & Stays",
      "a3.desc": "Pacchetti esperienziali dedicati: soggiorni in ville e castelli selezionati, itinerari culturali e weekend d'eccezione. I test drive in supercar sono disponibili nella sezione Supercar e potranno essere inclusi in future proposte esperienziali.",
      "a3.tag": "In arrivo",
      "a4.title": "Merchandising Ufficiale",
      "a4.desc": "Prodotti brandizzati LuxHaven360: ogni acquisto è un punto di contatto con un universo di riferimento, non un semplice acquisto commerciale.",
      "a4.tag": "Disponibile",
      "a5.title": "Comunicazione & PR",
      "a5.desc": "Collaborazioni con influencer e conciergerie di rango. Advertising mirato, eventi esclusivi e accesso a iniziative riservate alla community.",
      "a5.tag": "In pianificazione",
      "actmore.label": "E molto altro",
      "actmore.text": "La piattaforma è in continua espansione.",
      "actmore.cta": "Unisciti ora",
      "ben.label": "Perché LuxHaven360",
      "ben.title": "I vantaggi<br><em>concreti</em>",
      "b1.title": "Selezione Rigorosa",
      "b1.body": "Ogni proprietà, veicolo e bene è curato e verificato. Nessun contenuto generico: solo ciò che merita davvero attenzione.",
      "b2.title": "Accesso Anticipato",
      "b2.body": "Gli utenti della community ricevono accesso priority a nuovi listing, limited drops e opportunità esclusive prima di chiunque altro.",
      "b3.title": "Esperienze Riservate",
      "b3.body": "Inviti a eventi selezionati, soggiorni in dimore d'eccezione e iniziative speciali pensate per chi fa parte della community.",
      "b4.title": "Community Esclusiva",
      "b4.body": "Non una semplice piattaforma: una rete di persone con gusti raffinati, valori condivisi e aspirazioni autentiche.",
      "stat1": "Visione Completa",
      "stat2n": "Zero",
      "stat2": "Compromessi",
      "quote": "\"Ogni dettaglio è curato perché l'eccellenza non è un'opzione — è l'unico standard che accettiamo.\"",
      "plans.label": "Abbonamenti",
      "plans.title": "Scegli il tuo<br><em>livello di accesso</em>",
      "plans.subtitle": "I proventi degli abbonamenti supportano l'infrastruttura della piattaforma e finanziano vantaggi concreti per gli iscritti. Ogni piano è progettato per offrire un ritorno reale.",
      "permonth": "/ mese",
      "p1.tier": "Explorer",
      "p1.name": "Accesso",
      "p1.desc": "Il punto di partenza per scoprire l'universo LuxHaven360 e accedere ai contenuti della piattaforma.",
      "p1f1": "Accesso completo alla vetrina immobili e veicoli",
      "p1f2": "Newsletter mensile con contenuti esclusivi",
      "p1f3": "Sconto 5% sul merchandising ufficiale",
      "p1f4": "Partecipazione alla community base",
      "p1f5": "Accesso anticipato ai listing",
      "p1f6": "Inviti a eventi esclusivi",
      "p2.tier": "Prestige",
      "p2.name": "Privilegio",
      "p2.desc": "Per chi vuole essere tra i primi a scoprire nuove opportunità e vivere l'esperienza LuxHaven360 appieno.",
      "p2f1": "Tutto del piano Explorer",
      "p2f2": "Accesso anticipato a nuovi listing e drop",
      "p2f3": "Sconto 15% sul merchandising ufficiale",
      "p2f4": "Newsletter settimanale dedicata",
      "p2f5": "Badge verificato nella community",
      "p2f6": "Inviti prioritari a eventi selezionati",
      "p3.tier": "Élite",
      "p3.name": "Sovranità",
      "p3.desc": "L'accesso definitivo. Per chi non vuole confini e pretende il massimo da ogni interazione con LuxHaven360.",
      "p3f1": "Tutto del piano Prestige",
      "p3f2": "Accesso esclusivo a listing riservati",
      "p3f3": "Sconto 25% + prodotti limited edition",
      "p3f4": "Consulenza personalizzata dedicata",
      "p3f5": "Inviti a esperienze fisiche (soggiorni, eventi)",
      "p3f6": "Riconoscimento Fondatore nella community",
      "badge.popular": "Più Scelto",
      "plan.cta.start": "Inizia ora",
      "plan.cta.join": "Entra nel club",
      "plan.cta.elite": "Diventa Élite",
      "plans.note1": "I proventi degli abbonamenti coprono i costi di gestione del servizio",
      "plans.note2": "incluse le infrastrutture operative della piattaforma — e finanziano i vantaggi offerti agli iscritti.",
      "comm.label": "La Community",
      "comm.title": "Non un negozio.<br><em>Un universo.</em>",
      "comm.body": "LuxHaven360 è un'esperienza. Chi entra a far parte di questa realtà non è semplicemente un cliente: è parte di qualcosa di più grande. Una community selezionata, un brand che definisce uno stile di vita senza compromessi.",
      "comm.cta1": "Unisciti alla community",
      "comm.cta2": "Contattaci",
      "footer.tagline": "Eccellenza Senza Compromessi",
      "footer.copy": "© YEAR LuxHaven360. Tutti i diritti riservati.",
      "vetrina.label": "Vetrina & Promozione",
      "vetrina.title": "Ogni proprietà,<br><em>una storia da raccontare</em>",
      "vetrina.subtitle": "Showcase fotografici e video immersivi, schede dettagliate con gallerie e planimetrie, contenuti editoriali curati che valorizzano ogni dettaglio di ogni proprietà e veicolo.",
      "vetrina.tag.villa": "Villa Esclusiva · Toscana",
      "vetrina.tag.supercar": "Supercar · Limited Edition",
      "vetrina.tag.estate": "Residenza · Côte d'Azur",
      "vetrina.tag.villa2": "Villa · Lake Como",
      "vetrina.tag.car2": "Hypercar · Esclusivo",
      "vetrina.feat1": "Showcase fotografici ad alta risoluzione",
      "vetrina.feat2": "Video immersivi e tour virtuali",
      "vetrina.feat3": "Gallerie & Planimetrie dettagliate",
      "vetrina.feat4": "Contenuti editoriali esclusivi",
      "vetrina.cta": "Esplora la Vetrina Completa"
    },
    en: {
      "nav.about": "About",
      "nav.activities": "Services",
      "nav.showcase": "Showcase",
      "nav.benefits": "Benefits",
      "nav.plans": "Plans",
      "nav.mainsite": "Main Site",
      "hero.eyebrow": "Excellence Without Compromise",
      "hero.tagline": "The world that deserves your attention",
      "hero.desc": "An exclusive platform dedicated to prestigious properties, extraordinary vehicles and curated goods. Not mere commerce: an experience for those who accept no compromise.",
      "hero.cta1": "Explore the platform",
      "hero.cta2": "Plans & Subscriptions",
      "about.label": "About Us",
      "about.title": "A digital project<br><em>without precedent</em>",
      "about.body": "LuxHaven360 was born with the ambition of becoming the reference point for the sale, promotion and brokerage of prestigious properties, supercars and selected goods. Not just a showcase: a digital ecosystem that combines refined content, exclusive services and unique experiences.",
      "pillar1.title": "Prestigious Properties",
      "pillar1.body": "Villas, castles, historic residences and estates of rare beauty.",
      "pillar2.title": "Exclusive Vehicles",
      "pillar2.body": "Supercars, hypercars and exceptional automobiles carefully selected.",
      "pillar3.title": "Curated Goods",
      "pillar3.body": "Objects, experiences and branded products for an exclusive community.",
      "aboutcard.label": "Our mission",
      "aboutcard.title": "Beyond simple<br>buying and selling.",
      "act.label": "The Platform",
      "act.title": "Everything<br><em>we offer</em>",
      "act.subtitle": "A constantly evolving ecosystem, designed around the needs of those who don't settle.",
      "a1.title": "Showcase & Promotion",
      "a1.desc": "Photographic and immersive video showcases, detailed cards with galleries, floor plans and editorial content telling the story of each property and vehicle.",
      "a1.tag": "Active phase",
      "a2.title": "Listing & Brokerage",
      "a2.desc": "Sale listings and short to medium-term stays. Support for site visits, due diligence and full negotiation management.",
      "a2.tag": "Coming soon",
      "a3.title": "Experiences & Stays",
      "a3.desc": "Dedicated experiential packages: stays in selected villas and castles, cultural itineraries and exceptional weekends. Supercar test drives are available in the Supercar section and may be included in future experiential offerings.",
      "a3.tag": "Coming soon",
      "a4.title": "Official Merchandise",
      "a4.desc": "LuxHaven360 branded products: every purchase is a point of contact with a reference universe, not a simple commercial transaction.",
      "a4.tag": "Available",
      "a5.title": "Communication & PR",
      "a5.desc": "Collaborations with influencers and high-end concierges. Targeted advertising, exclusive events and access to initiatives reserved for the community.",
      "a5.tag": "In planning",
      "actmore.label": "And much more",
      "actmore.text": "The platform is constantly expanding.",
      "actmore.cta": "Join now",
      "ben.label": "Why LuxHaven360",
      "ben.title": "Concrete<br><em>advantages</em>",
      "b1.title": "Rigorous Selection",
      "b1.body": "Every property, vehicle and good is curated and verified. No generic content: only what truly deserves attention.",
      "b2.title": "Early Access",
      "b2.body": "Community members receive priority access to new listings, limited drops and exclusive opportunities before anyone else.",
      "b3.title": "Reserved Experiences",
      "b3.body": "Invitations to selected events, stays in exceptional residences and special initiatives designed for community members.",
      "b4.title": "Exclusive Community",
      "b4.body": "Not just a platform: a network of people with refined tastes, shared values and authentic aspirations.",
      "stat1": "Complete Vision",
      "stat2n": "Zero",
      "stat2": "Compromises",
      "quote": "\"Every detail is cared for because excellence is not an option — it is the only standard we accept.\"",
      "plans.label": "Subscriptions",
      "plans.title": "Choose your<br><em>level of access</em>",
      "plans.subtitle": "Subscription revenue supports the platform infrastructure and funds concrete benefits for members. Every plan is designed to deliver real value.",
      "permonth": "/ month",
      "p1.tier": "Explorer",
      "p1.name": "Access",
      "p1.desc": "The starting point to discover the LuxHaven360 universe and access platform content.",
      "p1f1": "Full access to property and vehicle showcase",
      "p1f2": "Monthly newsletter with exclusive content",
      "p1f3": "5% discount on official merchandise",
      "p1f4": "Basic community membership",
      "p1f5": "Early access to listings",
      "p1f6": "Invitations to exclusive events",
      "p2.tier": "Prestige",
      "p2.name": "Privilege",
      "p2.desc": "For those who want to be among the first to discover new opportunities and fully experience LuxHaven360.",
      "p2f1": "Everything in Explorer",
      "p2f2": "Early access to new listings and drops",
      "p2f3": "15% discount on official merchandise",
      "p2f4": "Dedicated weekly newsletter",
      "p2f5": "Verified badge in the community",
      "p2f6": "Priority invitations to selected events",
      "p3.tier": "Élite",
      "p3.name": "Sovereignty",
      "p3.desc": "The ultimate access. For those who want no boundaries and demand the best from every interaction with LuxHaven360.",
      "p3f1": "Everything in Prestige",
      "p3f2": "Exclusive access to reserved listings",
      "p3f3": "25% discount + limited edition products",
      "p3f4": "Dedicated personalized consulting",
      "p3f5": "Invitations to physical experiences (stays, events)",
      "p3f6": "Founder recognition in the community",
      "badge.popular": "Most Popular",
      "plan.cta.start": "Get started",
      "plan.cta.join": "Join the club",
      "plan.cta.elite": "Go Élite",
      "plans.note1": "Subscription revenue covers service management costs",
      "plans.note2": "including the platform's operational infrastructure — and funds the benefits offered to members.",
      "comm.label": "The Community",
      "comm.title": "Not a store.<br><em>A universe.</em>",
      "comm.body": "LuxHaven360 is an experience. Those who become part of this reality are not simply customers: they are part of something greater. A selected community, a brand that defines a lifestyle without compromise.",
      "comm.cta1": "Join the community",
      "comm.cta2": "Contact us",
      "footer.tagline": "Excellence Without Compromise",
      "footer.copy": "© YEAR LuxHaven360. All rights reserved.",
      "vetrina.label": "Showcase & Promotion",
      "vetrina.title": "Every property,<br><em>a story to be told</em>",
      "vetrina.subtitle": "Photographic and immersive video showcases, detailed cards with galleries and floor plans, curated editorial content that highlights every detail of each property and vehicle.",
      "vetrina.tag.villa": "Exclusive Villa · Tuscany",
      "vetrina.tag.supercar": "Supercar · Limited Edition",
      "vetrina.tag.estate": "Residence · Côte d'Azur",
      "vetrina.tag.villa2": "Villa · Lake Como",
      "vetrina.tag.car2": "Hypercar · Exclusive",
      "vetrina.feat1": "High-resolution photographic showcases",
      "vetrina.feat2": "Immersive videos & virtual tours",
      "vetrina.feat3": "Galleries & detailed floor plans",
      "vetrina.feat4": "Exclusive editorial content",
      "vetrina.cta": "Explore the Full Showcase"
    },
    fr: {
      "nav.about": "À Propos",
      "nav.activities": "Services",
      "nav.showcase": "Vitrine",
      "nav.benefits": "Avantages",
      "nav.plans": "Abonnements",
      "nav.mainsite": "Site Principal",
      "hero.eyebrow": "Excellence Sans Compromis",
      "hero.tagline": "Le monde qui mérite votre attention",
      "hero.desc": "Une plateforme exclusive dédiée aux propriétés de prestige, aux véhicules extraordinaires et aux biens sélectionnés. Pas simplement du commerce: une expérience pour ceux qui n'acceptent aucun compromis.",
      "hero.cta1": "Découvrir la plateforme",
      "hero.cta2": "Plans & Abonnements",
      "about.label": "Qui Sommes-Nous",
      "about.title": "Un projet numérique<br><em>sans précédent</em>",
      "about.body": "LuxHaven360 est né avec l'ambition de devenir la référence pour la vente, la promotion et l'intermédiation de propriétés de prestige, supercars et biens sélectionnés. Pas une simple vitrine: un écosystème numérique alliant contenus raffinés, services exclusifs et expériences uniques.",
      "pillar1.title": "Propriétés de Prestige",
      "pillar1.body": "Villas, châteaux, résidences historiques et demeures d'une beauté rare.",
      "pillar2.title": "Véhicules Exclusifs",
      "pillar2.body": "Supercars, hypercars et automobiles d'exception soigneusement sélectionnées.",
      "pillar3.title": "Biens Sélectionnés",
      "pillar3.body": "Objets, expériences et produits de marque pour une communauté exclusive.",
      "aboutcard.label": "Notre mission",
      "aboutcard.title": "Au-delà du simple<br>achat-vente.",
      "act.label": "La Plateforme",
      "act.title": "Tout ce que<br><em>nous offrons</em>",
      "act.subtitle": "Un écosystème en constante évolution, conçu autour des besoins de ceux qui ne se contentent pas de l'ordinaire.",
      "a1.title": "Vitrine & Promotion",
      "a1.desc": "Présentations photographiques et vidéos immersives, fiches détaillées avec galeries, plans et contenus éditoriaux racontant l'histoire de chaque propriété et véhicule.",
      "a1.tag": "Phase active",
      "a2.title": "Listing & Intermédiation",
      "a2.desc": "Annonces de vente et séjours à court et moyen terme. Support pour visites sur place, due diligence et gestion complète des négociations.",
      "a2.tag": "Bientôt",
      "a3.title": "Expériences & Séjours",
      "a3.desc": "Forfaits expérientiels dédiés: séjours dans des villas et châteaux sélectionnés, itinéraires culturels et week-ends d'exception. Les essais de supercars sont disponibles dans la section Supercar et pourront être intégrés dans de futures offres expérientielles.",
      "a3.tag": "Bientôt",
      "a4.title": "Merchandising Officiel",
      "a4.desc": "Produits de marque LuxHaven360: chaque achat est un point de contact avec un univers de référence, pas une simple transaction commerciale.",
      "a4.tag": "Disponible",
      "a5.title": "Communication & RP",
      "a5.desc": "Collaborations avec influenceurs et conciergeries haut de gamme. Publicité ciblée, événements exclusifs et accès aux initiatives réservées à la communauté.",
      "a5.tag": "En planification",
      "actmore.label": "Et bien plus",
      "actmore.text": "La plateforme est en constante expansion.",
      "actmore.cta": "Rejoindre maintenant",
      "ben.label": "Pourquoi LuxHaven360",
      "ben.title": "Les avantages<br><em>concrets</em>",
      "b1.title": "Sélection Rigoureuse",
      "b1.body": "Chaque propriété, véhicule et bien est soigné et vérifié. Aucun contenu générique: uniquement ce qui mérite vraiment l'attention.",
      "b2.title": "Accès Anticipé",
      "b2.body": "Les membres de la communauté reçoivent un accès prioritaire aux nouveaux listings, drops limités et opportunités exclusives avant tout le monde.",
      "b3.title": "Expériences Réservées",
      "b3.body": "Invitations à des événements sélectionnés, séjours dans des demeures d'exception et initiatives spéciales pour les membres de la communauté.",
      "b4.title": "Communauté Exclusive",
      "b4.body": "Pas une simple plateforme: un réseau de personnes aux goûts raffinés, aux valeurs partagées et aux aspirations authentiques.",
      "stat1": "Vision Complète",
      "stat2n": "Zéro",
      "stat2": "Compromis",
      "quote": "\"Chaque détail est soigné car l'excellence n'est pas une option — c'est la seule norme que nous acceptons.\"",
      "plans.label": "Abonnements",
      "plans.title": "Choisissez votre<br><em>niveau d'accès</em>",
      "plans.subtitle": "Les revenus des abonnements soutiennent l'infrastructure de la plateforme et financent des avantages concrets pour les membres.",
      "permonth": "/ mois",
      "p1.tier": "Explorer",
      "p1.name": "Accès",
      "p1.desc": "Le point de départ pour découvrir l'univers LuxHaven360 et accéder au contenu de la plateforme.",
      "p1f1": "Accès complet à la vitrine immobilier et véhicules",
      "p1f2": "Newsletter mensuelle avec contenu exclusif",
      "p1f3": "5% de réduction sur le merchandising officiel",
      "p1f4": "Adhésion à la communauté de base",
      "p1f5": "Accès anticipé aux listings",
      "p1f6": "Invitations à des événements exclusifs",
      "p2.tier": "Prestige",
      "p2.name": "Privilège",
      "p2.desc": "Pour ceux qui veulent être parmi les premiers à découvrir de nouvelles opportunités et vivre pleinement l'expérience LuxHaven360.",
      "p2f1": "Tout du plan Explorer",
      "p2f2": "Accès anticipé aux nouveaux listings et drops",
      "p2f3": "15% de réduction sur le merchandising officiel",
      "p2f4": "Newsletter hebdomadaire dédiée",
      "p2f5": "Badge vérifié dans la communauté",
      "p2f6": "Invitations prioritaires aux événements sélectionnés",
      "p3.tier": "Élite",
      "p3.name": "Souveraineté",
      "p3.desc": "L'accès ultime. Pour ceux qui ne veulent pas de limites et exigent le meilleur de chaque interaction avec LuxHaven360.",
      "p3f1": "Tout du plan Prestige",
      "p3f2": "Accès exclusif aux listings réservés",
      "p3f3": "25% de réduction + produits en édition limitée",
      "p3f4": "Conseil personnalisé dédié",
      "p3f5": "Invitations à des expériences physiques (séjours, événements)",
      "p3f6": "Reconnaissance Fondateur dans la communauté",
      "badge.popular": "Le Plus Choisi",
      "plan.cta.start": "Commencer",
      "plan.cta.join": "Rejoindre le club",
      "plan.cta.elite": "Devenir Élite",
      "plans.note1": "Les revenus des abonnements couvrent les coûts de gestion du service",
      "plans.note2": "incluant les infrastructures opérationnelles de la plateforme — et financent les avantages offerts aux membres.",
      "comm.label": "La Communauté",
      "comm.title": "Pas un magasin.<br><em>Un univers.</em>",
      "comm.body": "LuxHaven360 est une expérience. Ceux qui rejoignent cette réalité ne sont pas simplement des clients: ils font partie de quelque chose de plus grand. Une communauté sélectionnée, une marque qui définit un art de vivre sans compromis.",
      "comm.cta1": "Rejoindre la communauté",
      "comm.cta2": "Nous contacter",
      "footer.tagline": "Excellence Sans Compromis",
      "footer.copy": "© YEAR LuxHaven360. Tous droits réservés.",
      "vetrina.label": "Vitrine & Promotion",
      "vetrina.title": "Chaque propriété,<br><em>une histoire à raconter</em>",
      "vetrina.subtitle": "Présentations photographiques et vidéos immersives, fiches détaillées avec galeries et plans, contenus éditoriaux soignés qui mettent en valeur chaque détail de chaque propriété et véhicule.",
      "vetrina.tag.villa": "Villa Exclusive · Toscane",
      "vetrina.tag.supercar": "Supercar · Édition Limitée",
      "vetrina.tag.estate": "Résidence · Côte d'Azur",
      "vetrina.tag.villa2": "Villa · Lac de Côme",
      "vetrina.tag.car2": "Hypercar · Exclusif",
      "vetrina.feat1": "Showcases photographiques haute résolution",
      "vetrina.feat2": "Vidéos immersives & visites virtuelles",
      "vetrina.feat3": "Galeries & plans détaillés",
      "vetrina.feat4": "Contenus éditoriaux exclusifs",
      "vetrina.cta": "Explorer la Vitrine Complète"
    },
    de: {
      "nav.about": "Über Uns",
      "nav.activities": "Leistungen",
      "nav.showcase": "Schaufenster",
      "nav.benefits": "Vorteile",
      "nav.plans": "Abonnements",
      "nav.mainsite": "Hauptseite",
      "hero.eyebrow": "Exzellenz Ohne Kompromisse",
      "hero.tagline": "Die Welt, die Ihre Aufmerksamkeit verdient",
      "hero.desc": "Eine exklusive Plattform für Prestige-Immobilien, außergewöhnliche Fahrzeuge und ausgewählte Güter. Kein einfacher Handel: ein Erlebnis für diejenigen, die keine Kompromisse akzeptieren.",
      "hero.cta1": "Plattform entdecken",
      "hero.cta2": "Pläne & Abonnements",
      "about.label": "Über Uns",
      "about.title": "Ein digitales Projekt<br><em>ohne Präzedenzfall</em>",
      "about.body": "LuxHaven360 wurde mit dem Ziel gegründet, die Referenz für Verkauf, Vermarktung und Vermittlung von Prestige-Immobilien, Supercars und ausgewählten Gütern zu werden. Kein gewöhnliches Schaufenster: ein digitales Ökosystem, das raffinierte Inhalte, exklusive Dienstleistungen und einzigartige Erlebnisse verbindet.",
      "pillar1.title": "Prestige-Immobilien",
      "pillar1.body": "Villen, Schlösser, historische Residenzen und Anwesen von seltener Schönheit.",
      "pillar2.title": "Exklusive Fahrzeuge",
      "pillar2.body": "Supercars, Hypercars und außergewöhnliche Automobile, sorgfältig ausgewählt.",
      "pillar3.title": "Ausgewählte Güter",
      "pillar3.body": "Objekte, Erlebnisse und Markenprodukte für eine exklusive Community.",
      "aboutcard.label": "Unsere Mission",
      "aboutcard.title": "Jenseits des einfachen<br>Kaufens und Verkaufens.",
      "act.label": "Die Plattform",
      "act.title": "Alles, was<br><em>wir anbieten</em>",
      "act.subtitle": "Ein sich ständig weiterentwickelndes Ökosystem, das auf die Bedürfnisse derer ausgerichtet ist, die sich nicht mit dem Gewöhnlichen zufriedengeben.",
      "a1.title": "Schaufenster & Förderung",
      "a1.desc": "Fotografische und immersive Video-Präsentationen, detaillierte Karten mit Galerien, Grundrissen und redaktionellen Inhalten.",
      "a1.tag": "Aktive Phase",
      "a2.title": "Listing & Vermittlung",
      "a2.desc": "Verkaufsanzeigen und Kurz- bis Mittelfristaufenthalte. Unterstützung bei Vor-Ort-Besuchen, Due Diligence und vollständigem Verhandlungsmanagement.",
      "a2.tag": "Demnächst",
      "a3.title": "Erlebnisse & Aufenthalte",
      "a3.desc": "Dedizierte Erlebnispakete: Aufenthalte in ausgewählten Villen und Schlössern, kulturelle Touren und außergewöhnliche Wochenenden. Supercar-Testfahrten sind im Supercar-Bereich verfügbar und können in zukünftige Erlebnisangebote integriert werden.",
      "a3.tag": "Demnächst",
      "a4.title": "Offizielles Merchandise",
      "a4.desc": "LuxHaven360-Markenprodukte: Jeder Kauf ist ein Kontaktpunkt mit einem Referenzuniversum.",
      "a4.tag": "Verfügbar",
      "a5.title": "Kommunikation & PR",
      "a5.desc": "Kooperationen mit Influencern und Hochklasse-Concierges. Gezieltes Advertising und Zugang zu Community-Initiativen.",
      "a5.tag": "In Planung",
      "actmore.label": "Und vieles mehr",
      "actmore.text": "Die Plattform befindet sich in ständiger Expansion.",
      "actmore.cta": "Jetzt beitreten",
      "ben.label": "Warum LuxHaven360",
      "ben.title": "Konkrete<br><em>Vorteile</em>",
      "b1.title": "Strenge Auswahl",
      "b1.body": "Jede Immobilie, jedes Fahrzeug und jedes Gut wird sorgfältig geprüft. Kein generischer Inhalt: nur das, was wirklich Aufmerksamkeit verdient.",
      "b2.title": "Früher Zugang",
      "b2.body": "Community-Mitglieder erhalten Prioritätszugang zu neuen Listings, Limited Drops und exklusiven Möglichkeiten vor allen anderen.",
      "b3.title": "Reservierte Erlebnisse",
      "b3.body": "Einladungen zu ausgewählten Events, Aufenthalte in außergewöhnlichen Residenzen und Sonderinitiativen für Community-Mitglieder.",
      "b4.title": "Exklusive Community",
      "b4.body": "Nicht nur eine Plattform: ein Netzwerk von Menschen mit verfeinerten Geschmäckern, gemeinsamen Werten und authentischen Ambitionen.",
      "stat1": "Vollständige Vision",
      "stat2n": "Null",
      "stat2": "Kompromisse",
      "quote": "\"Jedes Detail wird gepflegt, denn Exzellenz ist keine Option — sie ist der einzige Standard, den wir akzeptieren.\"",
      "plans.label": "Abonnements",
      "plans.title": "Wählen Sie Ihre<br><em>Zugangsstufe</em>",
      "plans.subtitle": "Abonnementeinnahmen unterstützen die Plattforminfrastruktur und finanzieren konkrete Vorteile für Mitglieder.",
      "permonth": "/ Monat",
      "p1.tier": "Explorer",
      "p1.name": "Zugang",
      "p1.desc": "Der Ausgangspunkt zur Entdeckung des LuxHaven360-Universums.",
      "p1f1": "Vollständiger Zugang zur Immobilien- und Fahrzeugvitrine",
      "p1f2": "Monatlicher Newsletter mit exklusiven Inhalten",
      "p1f3": "5% Rabatt auf offizielles Merchandise",
      "p1f4": "Basis-Community-Mitgliedschaft",
      "p1f5": "Frühzeitiger Zugang zu Listings",
      "p1f6": "Einladungen zu exklusiven Events",
      "p2.tier": "Prestige",
      "p2.name": "Privileg",
      "p2.desc": "Für diejenigen, die zu den Ersten gehören möchten, die neue Möglichkeiten entdecken.",
      "p2f1": "Alles aus dem Explorer-Plan",
      "p2f2": "Früher Zugang zu neuen Listings und Drops",
      "p2f3": "15% Rabatt auf offizielles Merchandise",
      "p2f4": "Dedizierter wöchentlicher Newsletter",
      "p2f5": "Verifiziertes Abzeichen in der Community",
      "p2f6": "Prioritätseinladungen zu ausgewählten Events",
      "p3.tier": "Élite",
      "p3.name": "Souveränität",
      "p3.desc": "Der ultimative Zugang. Für diejenigen, die keine Grenzen wollen.",
      "p3f1": "Alles aus dem Prestige-Plan",
      "p3f2": "Exklusiver Zugang zu reservierten Listings",
      "p3f3": "25% Rabatt + Limited-Edition-Produkte",
      "p3f4": "Dedizierte persönliche Beratung",
      "p3f5": "Einladungen zu physischen Erlebnissen",
      "p3f6": "Gründer-Anerkennung in der Community",
      "badge.popular": "Am Beliebtesten",
      "plan.cta.start": "Jetzt starten",
      "plan.cta.join": "Club beitreten",
      "plan.cta.elite": "Élite werden",
      "plans.note1": "Abonnementeinnahmen decken die Service-Verwaltungskosten",
      "plans.note2": "einschließlich der operativen Infrastruktur der Plattform — und finanzieren die Vorteile für Mitglieder.",
      "comm.label": "Die Community",
      "comm.title": "Kein Geschäft.<br><em>Ein Universum.</em>",
      "comm.body": "LuxHaven360 ist ein Erlebnis. Wer Teil dieser Realität wird, ist nicht einfach ein Kunde: er ist Teil von etwas Größerem.",
      "comm.cta1": "Community beitreten",
      "comm.cta2": "Kontakt",
      "footer.tagline": "Exzellenz Ohne Kompromisse",
      "footer.copy": "© YEAR LuxHaven360. Alle Rechte vorbehalten.",
      "vetrina.label": "Schaufenster & Promotion",
      "vetrina.title": "Jede Immobilie,<br><em>eine Geschichte zu erzählen</em>",
      "vetrina.subtitle": "Fotografische und immersive Video-Präsentationen, detaillierte Karten mit Galerien und Grundrissen, kuratierte redaktionelle Inhalte, die jedes Detail jeder Immobilie und jedes Fahrzeugs hervorheben.",
      "vetrina.tag.villa": "Exklusive Villa · Toskana",
      "vetrina.tag.supercar": "Supercar · Limited Edition",
      "vetrina.tag.estate": "Residenz · Côte d'Azur",
      "vetrina.tag.villa2": "Villa · Comer See",
      "vetrina.tag.car2": "Hypercar · Exklusiv",
      "vetrina.feat1": "Hochauflösende fotografische Showcases",
      "vetrina.feat2": "Immersive Videos & virtuelle Touren",
      "vetrina.feat3": "Galerien & detaillierte Grundrisse",
      "vetrina.feat4": "Exklusive redaktionelle Inhalte",
      "vetrina.cta": "Das vollständige Schaufenster erkunden"
    },
    es: {
      "nav.about": "Quiénes Somos",
      "nav.activities": "Servicios",
      "nav.showcase": "Escaparate",
      "nav.benefits": "Ventajas",
      "nav.plans": "Suscripciones",
      "nav.mainsite": "Sitio Principal",
      "hero.eyebrow": "Excelencia Sin Compromisos",
      "hero.tagline": "El mundo que merece tu atención",
      "hero.desc": "Una plataforma exclusiva dedicada a propiedades de prestigio, vehículos extraordinarios y bienes seleccionados. No es simple comercio: una experiencia para quienes no aceptan compromisos.",
      "hero.cta1": "Explorar la plataforma",
      "hero.cta2": "Planes & Suscripciones",
      "about.label": "Quiénes Somos",
      "about.title": "Un proyecto digital<br><em>sin precedentes</em>",
      "about.body": "LuxHaven360 nació con la ambición de convertirse en el punto de referencia para la venta, promoción e intermediación de propiedades de prestigio, supercars y bienes seleccionados. No es una simple vitrina: un ecosistema digital que une contenidos refinados, servicios exclusivos y experiencias únicas.",
      "pillar1.title": "Propiedades de Prestigio",
      "pillar1.body": "Villas, castillos, residencias históricas y mansiones de rara belleza.",
      "pillar2.title": "Vehículos Exclusivos",
      "pillar2.body": "Supercars, hypercars y automóviles de excepción cuidadosamente seleccionados.",
      "pillar3.title": "Bienes Seleccionados",
      "pillar3.body": "Objetos, experiencias y productos de marca para una comunidad exclusiva.",
      "aboutcard.label": "Nuestra misión",
      "aboutcard.title": "Más allá de la simple<br>compraventa.",
      "act.label": "La Plataforma",
      "act.title": "Todo lo que<br><em>ofrecemos</em>",
      "act.subtitle": "Un ecosistema en constante evolución, diseñado en torno a las necesidades de quienes no se conforman.",
      "a1.title": "Vitrina & Promoción",
      "a1.desc": "Presentaciones fotográficas y de video inmersivas, fichas detalladas con galerías, planos y contenidos editoriales que cuentan la historia de cada propiedad y vehículo.",
      "a1.tag": "Fase activa",
      "a2.title": "Listing & Intermediación",
      "a2.desc": "Anuncios de venta y estancias a corto y medio plazo. Soporte para visitas, due diligence y gestión completa de negociaciones.",
      "a2.tag": "Próximamente",
      "a3.title": "Experiencias & Estancias",
      "a3.desc": "Paquetes experienciales dedicados: estancias en villas y castillos seleccionados, itinerarios culturales y fines de semana de excepción. Las pruebas de supercars están disponibles en la sección Supercar y podrán incluirse en futuras propuestas experienciales.",
      "a3.tag": "Próximamente",
      "a4.title": "Merchandising Oficial",
      "a4.desc": "Productos de marca LuxHaven360: cada compra es un punto de contacto con un universo de referencia, no una simple transacción comercial.",
      "a4.tag": "Disponible",
      "a5.title": "Comunicación & PR",
      "a5.desc": "Colaboraciones con influencers y conserjerías de alto nivel. Publicidad dirigida, eventos exclusivos y acceso a iniciativas reservadas a la comunidad.",
      "a5.tag": "En planificación",
      "actmore.label": "Y mucho más",
      "actmore.text": "La plataforma está en constante expansión.",
      "actmore.cta": "Únete ahora",
      "ben.label": "Por qué LuxHaven360",
      "ben.title": "Las ventajas<br><em>concretas</em>",
      "b1.title": "Selección Rigurosa",
      "b1.body": "Cada propiedad, vehículo y bien está cuidado y verificado. Sin contenido genérico: solo lo que realmente merece atención.",
      "b2.title": "Acceso Anticipado",
      "b2.body": "Los miembros de la comunidad reciben acceso prioritario a nuevos listings, limited drops y oportunidades exclusivas antes que nadie.",
      "b3.title": "Experiencias Reservadas",
      "b3.body": "Invitaciones a eventos seleccionados, estancias en residencias de excepción e iniciativas especiales para los miembros de la comunidad.",
      "b4.title": "Comunidad Exclusiva",
      "b4.body": "No solo una plataforma: una red de personas con gustos refinados, valores compartidos y aspiraciones auténticas.",
      "stat1": "Visión Completa",
      "stat2n": "Cero",
      "stat2": "Compromisos",
      "quote": "\"Cada detalle está cuidado porque la excelencia no es una opción — es el único estándar que aceptamos.\"",
      "plans.label": "Suscripciones",
      "plans.title": "Elige tu<br><em>nivel de acceso</em>",
      "plans.subtitle": "Los ingresos de las suscripciones apoyan la infraestructura de la plataforma y financian ventajas concretas para los miembros.",
      "permonth": "/ mes",
      "p1.tier": "Explorer",
      "p1.name": "Acceso",
      "p1.desc": "El punto de partida para descubrir el universo LuxHaven360.",
      "p1f1": "Acceso completo a la vitrina de inmuebles y vehículos",
      "p1f2": "Newsletter mensual con contenido exclusivo",
      "p1f3": "5% de descuento en merchandising oficial",
      "p1f4": "Membresía básica en la comunidad",
      "p1f5": "Acceso anticipado a listings",
      "p1f6": "Invitaciones a eventos exclusivos",
      "p2.tier": "Prestige",
      "p2.name": "Privilegio",
      "p2.desc": "Para quienes quieren estar entre los primeros en descubrir nuevas oportunidades.",
      "p2f1": "Todo del plan Explorer",
      "p2f2": "Acceso anticipado a nuevos listings y drops",
      "p2f3": "15% de descuento en merchandising oficial",
      "p2f4": "Newsletter semanal dedicada",
      "p2f5": "Insignia verificada en la comunidad",
      "p2f6": "Invitaciones prioritarias a eventos seleccionados",
      "p3.tier": "Élite",
      "p3.name": "Soberanía",
      "p3.desc": "El acceso definitivo. Para quienes no quieren límites y exigen lo mejor de cada interacción con LuxHaven360.",
      "p3f1": "Todo del plan Prestige",
      "p3f2": "Acceso exclusivo a listings reservados",
      "p3f3": "25% de descuento + productos de edición limitada",
      "p3f4": "Consultoría personalizada dedicada",
      "p3f5": "Invitaciones a experiencias físicas (estancias, eventos)",
      "p3f6": "Reconocimiento Fundador en la comunidad",
      "badge.popular": "Más Elegido",
      "plan.cta.start": "Empezar ahora",
      "plan.cta.join": "Entrar al club",
      "plan.cta.elite": "Ser Élite",
      "plans.note1": "Los ingresos de suscripciones cubren los costos de gestión del servicio",
      "plans.note2": "incluidas las infraestructuras operativas de la plataforma — y financian las ventajas ofrecidas a los miembros.",
      "comm.label": "La Comunidad",
      "comm.title": "No una tienda.<br><em>Un universo.</em>",
      "comm.body": "LuxHaven360 es una experiencia. Quien se convierte en parte de esta realidad no es simplemente un cliente: es parte de algo más grande.",
      "comm.cta1": "Únete a la comunidad",
      "comm.cta2": "Contáctanos",
      "footer.tagline": "Excelencia Sin Compromisos",
      "footer.copy": "© YEAR LuxHaven360. Todos los derechos reservados.",
      "vetrina.label": "Escaparate & Promoción",
      "vetrina.title": "Cada propiedad,<br><em>una historia que contar</em>",
      "vetrina.subtitle": "Presentaciones fotográficas y videos inmersivos, fichas detalladas con galerías y planos, contenidos editoriales cuidados que destacan cada detalle de cada propiedad y vehículo.",
      "vetrina.tag.villa": "Villa Exclusiva · Toscana",
      "vetrina.tag.supercar": "Supercar · Edición Limitada",
      "vetrina.tag.estate": "Residencia · Costa Azul",
      "vetrina.tag.villa2": "Villa · Lago de Como",
      "vetrina.tag.car2": "Hypercar · Exclusivo",
      "vetrina.feat1": "Showcases fotográficos de alta resolución",
      "vetrina.feat2": "Videos inmersivos y visitas virtuales",
      "vetrina.feat3": "Galerías y planos detallados",
      "vetrina.feat4": "Contenidos editoriales exclusivos",
      "vetrina.cta": "Explorar el Escaparate Completo"
    }
  };

  /* ── I18N ADDITIONS ── */
  // Aggiunge le chiavi auth a tutti i dizionari esistenti
  const authI18n = {
    it: {
      'auth.tab.register': "Registrati",
      'auth.tab.login': "Accedi",
      'auth.register.title': "Crea il tuo account",
      'auth.login.title': "Accedi al tuo account",
      'auth.firstname': "Nome",
      'auth.lastname': "Cognome",
      'auth.email': "Email",
      'auth.password': "Password",
      'auth.confirm_password': "Conferma Password",
      'auth.register.btn': "Crea account e procedi al pagamento",
      'auth.login.btn': "Accedi e procedi al pagamento",
      'auth.register.note': "Hai già un account? <a onclick=\"switchTab('login')\">Accedi</a>",
      'auth.login.note': "Non hai un account? <a onclick=\"switchTab('register')\">Registrati</a>",
      'auth.redirecting': "Reindirizzamento a Stripe in corso...",
      'auth.err.name': "Inserisci nome e cognome.",
      'auth.err.email': "Email non valida.",
      'auth.err.pwdlen': "La password deve avere almeno 8 caratteri.",
      'auth.err.pwdmatch': "Le password non coincidono.",
      'auth.err.exists': "Account già esistente. Accedi.",
      'auth.err.empty': "Compila tutti i campi.",
      'auth.err.notfound': "Account non trovato. Registrati.",
      'auth.err.wrongpwd': "Password errata.",
      'profile.subscription': "Abbonamento",
      'profile.plan': "Piano",
      'profile.status': "Stato",
      'profile.start': "Data inizio",
      'profile.expires': "Scadenza",
      'profile.autorenew': "Rinnovo automatico",
      'profile.billing_period': "Tipo abbonamento",
      'profile.renew_btn': "Rinnova / Cambia piano",
      'profile.logout': "Esci dall'account",
      'profile.badge.active': "Attivo",
      'profile.badge.inactive': "Non attivo",
      'profile.badge.none': "Nessun piano",
      'profile.no_plan': "Nessun piano attivo",
      'profile.yes': "Sì",
      'profile.no': "No",
      'profile.cancel_btn': "Termina abbonamento",
      'profile.cancel_confirm': "L'abbonamento rimarrà attivo fino alla scadenza e non verrà rinnovato. Confermi?",
      'profile.cancel_yes': "Sì, termina",
      'profile.cancel_no': "Annulla",
      'profile.cancel_toast': "Abbonamento terminato con successo.",
      'toast.welcome': "Benvenuto,",
      'toast.logout': "Disconnesso con successo.",
      'auth.checkout.title': "Procedi al pagamento",
      'auth.close': "Chiudi",
      'auth.err.notconfigured': "⚙️ Apps Script non ancora configurato. Segui le istruzioni nel file Abbonamenti.gs per attivare il pagamento Stripe.",
      'auth.err.connection': "Errore di connessione. Verifica la configurazione di Apps Script e riprova.",
      'auth.forgot.link': "Password dimenticata?",
      'auth.forgot.title': "Ripristina password",
      'auth.forgot.back': "Torna al login",
      'auth.forgot.back_step1': "Modifica email",
      'auth.forgot.send': "Invia codice di verifica",
      'auth.forgot.step2_hint': "Inserisci il codice a 6 cifre ricevuto via email.",
      'auth.forgot.new_pwd': "Nuova password",
      'auth.forgot.confirm': "Imposta nuova password",
      'auth.forgot.resend': "Non hai ricevuto il codice? Invia di nuovo",
      'auth.forgot.resent': "Codice inviato di nuovo.",
      'auth.forgot.success': "Password aggiornata con successo. Accedi con la nuova password.",
      'auth.forgot.err.code': "Inserisci il codice completo a 6 cifre.",
      'auth.forgot.err.invalid': "Codice non valido. Controlla l'email e riprova.",
      'plans.billing.monthly': "Mensile",
      'plans.billing.annual': "Annuale",
      'plans.billing.save': "Risparmia ~20%",
      'plans.billing.billed_annual': "Fatturato {amt} / anno",
      'plans.billing.per_year': "/ anno",
    },
    en: {
      'auth.tab.register': "Sign Up",
      'auth.tab.login': "Sign In",
      'auth.register.title': "Create your account",
      'auth.login.title': "Sign in to your account",
      'auth.firstname': "First Name",
      'auth.lastname': "Last Name",
      'auth.email': "Email",
      'auth.password': "Password",
      'auth.confirm_password': "Confirm Password",
      'auth.register.btn': "Create account & proceed to payment",
      'auth.login.btn': "Sign in & proceed to payment",
      'auth.register.note': "Already have an account? <a onclick=\"switchTab('login')\">Sign in</a>",
      'auth.login.note': "No account yet? <a onclick=\"switchTab('register')\">Sign up</a>",
      'auth.redirecting': "Redirecting to Stripe...",
      'auth.err.name': "Please enter your name and surname.",
      'auth.err.email': "Invalid email address.",
      'auth.err.pwdlen': "Password must be at least 8 characters.",
      'auth.err.pwdmatch': "Passwords do not match.",
      'auth.err.exists': "Account already exists. Please sign in.",
      'auth.err.empty': "Please fill in all fields.",
      'auth.err.notfound': "Account not found. Please sign up.",
      'auth.err.wrongpwd': "Incorrect password.",
      'profile.subscription': "Subscription",
      'profile.plan': "Plan",
      'profile.status': "Status",
      'profile.start': "Start date",
      'profile.expires': "Expires",
      'profile.autorenew': "Auto-renewal",
      'profile.billing_period': "Subscription type",
      'profile.renew_btn': "Renew / Change plan",
      'profile.logout': "Sign out",
      'profile.badge.active': "Active",
      'profile.badge.inactive': "Inactive",
      'profile.badge.none': "No plan",
      'profile.no_plan': "No active plan",
      'profile.yes': "Yes",
      'profile.no': "No",
      'profile.cancel_btn': "Cancel subscription",
      'profile.cancel_confirm': "Your subscription will remain active until expiry and will not be renewed. Confirm cancellation?",
      'profile.cancel_yes': "Yes, cancel",
      'profile.cancel_no': "Keep it",
      'profile.cancel_toast': "Subscription cancelled successfully.",
      'toast.welcome': "Welcome,",
      'toast.logout': "Signed out successfully.",
      'auth.checkout.title': "Proceed to payment",
      'auth.close': "Close",
      'auth.err.notconfigured': "⚙️ Apps Script not configured yet. Follow the instructions in Abbonamenti.gs to activate Stripe payments.",
      'auth.err.connection': "Connection error. Please check the Apps Script configuration and try again.",
      'auth.forgot.link': "Forgot password?",
      'auth.forgot.title': "Reset your password",
      'auth.forgot.back': "Back to login",
      'auth.forgot.back_step1': "Edit email",
      'auth.forgot.send': "Send verification code",
      'auth.forgot.step2_hint': "Enter the 6-digit code sent to your email.",
      'auth.forgot.new_pwd': "New password",
      'auth.forgot.confirm': "Set new password",
      'auth.forgot.resend': "Didn't receive the code? Send again",
      'auth.forgot.resent': "Code sent again.",
      'auth.forgot.success': "Password updated. Sign in with your new password.",
      'auth.forgot.err.code': "Please enter the complete 6-digit code.",
      'auth.forgot.err.invalid': "Invalid code. Check your email and try again.",
      'plans.billing.monthly': "Monthly",
      'plans.billing.annual': "Annual",
      'plans.billing.save': "Save ~20%",
      'plans.billing.billed_annual': "Billed {amt} / year",
      'plans.billing.per_year': "/ year",
    },
    fr: {
      'auth.tab.register': "S'inscrire",
      'auth.tab.login': "Se connecter",
      'auth.register.title': "Créer votre compte",
      'auth.login.title': "Accéder à votre compte",
      'auth.firstname': "Prénom",
      'auth.lastname': "Nom de famille",
      'auth.email': "Email",
      'auth.password': "Mot de passe",
      'auth.confirm_password': "Confirmer le mot de passe",
      'auth.register.btn': "Créer un compte et procéder au paiement",
      'auth.login.btn': "Se connecter et procéder au paiement",
      'auth.register.note': "Vous avez déjà un compte? <a onclick=\"switchTab('login')\">Se connecter</a>",
      'auth.login.note': "Pas encore de compte? <a onclick=\"switchTab('register')\">S'inscrire</a>",
      'auth.redirecting': "Redirection vers Stripe...",
      'auth.err.name': "Veuillez entrer votre prénom et nom.",
      'auth.err.email': "Adresse email invalide.",
      'auth.err.pwdlen': "Le mot de passe doit comporter au moins 8 caractères.",
      'auth.err.pwdmatch': "Les mots de passe ne correspondent pas.",
      'auth.err.exists': "Compte déjà existant. Connectez-vous.",
      'auth.err.empty': "Veuillez remplir tous les champs.",
      'auth.err.notfound': "Compte non trouvé. Inscrivez-vous.",
      'auth.err.wrongpwd': "Mot de passe incorrect.",
      'profile.subscription': "Abonnement",
      'profile.plan': "Plan",
      'profile.status': "Statut",
      'profile.start': "Date de début",
      'profile.expires': "Expire le",
      'profile.autorenew': "Renouvellement automatique",
      'profile.billing_period': "Type d'abonnement",
      'profile.renew_btn': "Renouveler / Changer de plan",
      'profile.logout': "Se déconnecter",
      'profile.badge.active': "Actif",
      'profile.badge.inactive': "Inactif",
      'profile.badge.none': "Aucun plan",
      'profile.no_plan': "Aucun plan actif",
      'profile.yes': "Oui",
      'profile.no': "Non",
      'profile.cancel_btn': "Résilier l'abonnement",
      'profile.cancel_confirm': "Votre abonnement restera actif jusqu'à l'expiration et ne sera pas renouvelé. Confirmer?",
      'profile.cancel_yes': "Oui, résilier",
      'profile.cancel_no': "Conserver",
      'profile.cancel_toast': "Abonnement résilié avec succès.",
      'toast.welcome': "Bienvenue,",
      'toast.logout': "Déconnexion réussie.",
      'auth.checkout.title': "Procéder au paiement",
      'auth.close': "Fermer",
      'auth.err.notconfigured': "⚙️ Apps Script non configuré. Suivez les instructions dans Abbonamenti.gs pour activer les paiements Stripe.",
      'auth.err.connection': "Erreur de connexion. Vérifiez la configuration Apps Script et réessayez.",
      'auth.forgot.link': "Mot de passe oublié?",
      'auth.forgot.title': "Réinitialiser le mot de passe",
      'auth.forgot.back': "Retour à la connexion",
      'auth.forgot.back_step1': "Modifier l'email",
      'auth.forgot.send': "Envoyer le code de vérification",
      'auth.forgot.step2_hint': "Entrez le code à 6 chiffres reçu par email.",
      'auth.forgot.new_pwd': "Nouveau mot de passe",
      'auth.forgot.confirm': "Définir le nouveau mot de passe",
      'auth.forgot.resend': "Vous n'avez pas reçu le code? Renvoyer",
      'auth.forgot.resent': "Code renvoyé.",
      'auth.forgot.success': "Mot de passe mis à jour. Connectez-vous avec votre nouveau mot de passe.",
      'auth.forgot.err.code': "Veuillez entrer le code complet à 6 chiffres.",
      'auth.forgot.err.invalid': "Code invalide. Vérifiez votre email et réessayez.",
      'plans.billing.monthly': "Mensuel",
      'plans.billing.annual': "Annuel",
      'plans.billing.save': "Économisez ~20%",
      'plans.billing.billed_annual': "Facturé {amt} / an",
      'plans.billing.per_year': "/ an",
    },
    de: {
      'auth.tab.register': "Registrieren",
      'auth.tab.login': "Anmelden",
      'auth.register.title': "Konto erstellen",
      'auth.login.title': "In Ihr Konto einloggen",
      'auth.firstname': "Vorname",
      'auth.lastname': "Nachname",
      'auth.email': "E-Mail",
      'auth.password': "Passwort",
      'auth.confirm_password': "Passwort bestätigen",
      'auth.register.btn': "Konto erstellen & zur Zahlung",
      'auth.login.btn': "Anmelden & zur Zahlung",
      'auth.register.note': "Haben Sie bereits ein Konto? <a onclick=\"switchTab('login')\">Anmelden</a>",
      'auth.login.note': "Noch kein Konto? <a onclick=\"switchTab('register')\">Registrieren</a>",
      'auth.redirecting': "Weiterleitung zu Stripe...",
      'auth.err.name': "Bitte geben Sie Vor- und Nachnamen ein.",
      'auth.err.email': "Ungültige E-Mail-Adresse.",
      'auth.err.pwdlen': "Das Passwort muss mindestens 8 Zeichen lang sein.",
      'auth.err.pwdmatch': "Die Passwörter stimmen nicht überein.",
      'auth.err.exists': "Konto existiert bereits. Bitte anmelden.",
      'auth.err.empty': "Bitte alle Felder ausfüllen.",
      'auth.err.notfound': "Konto nicht gefunden. Bitte registrieren.",
      'auth.err.wrongpwd': "Falsches Passwort.",
      'profile.subscription': "Abonnement",
      'profile.plan': "Plan",
      'profile.status': "Status",
      'profile.start': "Startdatum",
      'profile.expires': "Läuft ab",
      'profile.autorenew': "Automatische Verlängerung",
      'profile.billing_period': "Abonnementtyp",
      'profile.renew_btn': "Erneuern / Plan ändern",
      'profile.logout': "Abmelden",
      'profile.badge.active': "Aktiv",
      'profile.badge.inactive': "Inaktiv",
      'profile.badge.none': "Kein Plan",
      'profile.no_plan': "Kein aktiver Plan",
      'profile.yes': "Ja",
      'profile.no': "Nein",
      'profile.cancel_btn': "Abonnement kündigen",
      'profile.cancel_confirm': "Ihr Abonnement bleibt bis zum Ablaufdatum aktiv und wird nicht verlängert. Kündigung bestätigen?",
      'profile.cancel_yes': "Ja, kündigen",
      'profile.cancel_no': "Behalten",
      'profile.cancel_toast': "Abonnement erfolgreich gekündigt.",
      'toast.welcome': "Willkommen,",
      'toast.logout': "Erfolgreich abgemeldet.",
      'auth.checkout.title': "Zur Zahlung",
      'auth.close': "Schließen",
      'auth.err.notconfigured': "⚙️ Apps Script noch nicht konfiguriert. Folgen Sie den Anweisungen in Abbonamenti.gs.",
      'auth.err.connection': "Verbindungsfehler. Überprüfen Sie die Apps Script-Konfiguration und versuchen Sie es erneut.",
      'auth.forgot.link': "Passwort vergessen?",
      'auth.forgot.title': "Passwort zurücksetzen",
      'auth.forgot.back': "Zurück zum Login",
      'auth.forgot.back_step1': "E-Mail ändern",
      'auth.forgot.send': "Verifizierungscode senden",
      'auth.forgot.step2_hint': "Geben Sie den 6-stelligen Code aus Ihrer E-Mail ein.",
      'auth.forgot.new_pwd': "Neues Passwort",
      'auth.forgot.confirm': "Neues Passwort festlegen",
      'auth.forgot.resend': "Code nicht erhalten? Erneut senden",
      'auth.forgot.resent': "Code erneut gesendet.",
      'auth.forgot.success': "Passwort aktualisiert. Melden Sie sich mit dem neuen Passwort an.",
      'auth.forgot.err.code': "Bitte geben Sie den vollständigen 6-stelligen Code ein.",
      'auth.forgot.err.invalid': "Ungültiger Code. Überprüfen Sie Ihre E-Mail und versuchen Sie es erneut.",
      'plans.billing.monthly': "Monatlich",
      'plans.billing.annual': "Jährlich",
      'plans.billing.save': "~20% sparen",
      'plans.billing.billed_annual': "{amt} / Jahr abgerechnet",
      'plans.billing.per_year': "/ Jahr",
    },
    es: {
      'auth.tab.register': "Registrarse",
      'auth.tab.login': "Iniciar sesión",
      'auth.register.title': "Crear tu cuenta",
      'auth.login.title': "Acceder a tu cuenta",
      'auth.firstname': "Nombre",
      'auth.lastname': "Apellido",
      'auth.email': "Email",
      'auth.password': "Contraseña",
      'auth.confirm_password': "Confirmar contraseña",
      'auth.register.btn': "Crear cuenta y proceder al pago",
      'auth.login.btn': "Iniciar sesión y proceder al pago",
      'auth.register.note': "¿Ya tienes una cuenta? <a onclick=\"switchTab('login')\">Iniciar sesión</a>",
      'auth.login.note': "¿No tienes cuenta? <a onclick=\"switchTab('register')\">Registrarse</a>",
      'auth.redirecting': "Redirigiendo a Stripe...",
      'auth.err.name': "Por favor ingresa nombre y apellido.",
      'auth.err.email': "Dirección de email inválida.",
      'auth.err.pwdlen': "La contraseña debe tener al menos 8 caracteres.",
      'auth.err.pwdmatch': "Las contraseñas no coinciden.",
      'auth.err.exists': "Cuenta ya existente. Por favor inicia sesión.",
      'auth.err.empty': "Por favor rellena todos los campos.",
      'auth.err.notfound': "Cuenta no encontrada. Regístrate.",
      'auth.err.wrongpwd': "Contraseña incorrecta.",
      'profile.subscription': "Suscripción",
      'profile.plan': "Plan",
      'profile.status': "Estado",
      'profile.start': "Fecha de inicio",
      'profile.expires': "Vence el",
      'profile.autorenew': "Renovación automática",
      'profile.billing_period': "Tipo de suscripción",
      'profile.renew_btn': "Renovar / Cambiar plan",
      'profile.logout': "Cerrar sesión",
      'profile.badge.active': "Activo",
      'profile.badge.inactive': "Inactivo",
      'profile.badge.none': "Sin plan",
      'profile.no_plan': "Sin plan activo",
      'profile.yes': "Sí",
      'profile.no': "No",
      'profile.cancel_btn': "Cancelar suscripción",
      'profile.cancel_confirm': "Tu suscripción permanecerá activa hasta la fecha de vencimiento y no se renovará. ¿Confirmas?",
      'profile.cancel_yes': "Sí, cancelar",
      'profile.cancel_no': "Mantener",
      'profile.cancel_toast': "Suscripción cancelada con éxito.",
      'toast.welcome': "Bienvenido,",
      'toast.logout': "Sesión cerrada correctamente.",
      'auth.checkout.title': "Proceder al pago",
      'auth.close': "Cerrar",
      'auth.err.notconfigured': "⚙️ Apps Script no configurado aún. Sigue las instrucciones en Abbonamenti.gs para activar los pagos de Stripe.",
      'auth.err.connection': "Error de conexión. Verifica la configuración de Apps Script e inténtalo de nuevo.",
      'auth.forgot.link': "¿Olvidaste tu contraseña?",
      'auth.forgot.title': "Restablecer contraseña",
      'auth.forgot.back': "Volver al inicio de sesión",
      'auth.forgot.back_step1': "Editar email",
      'auth.forgot.send': "Enviar código de verificación",
      'auth.forgot.step2_hint': "Introduce el código de 6 dígitos recibido por email.",
      'auth.forgot.new_pwd': "Nueva contraseña",
      'auth.forgot.confirm': "Establecer nueva contraseña",
      'auth.forgot.resend': "¿No recibiste el código? Enviar de nuevo",
      'auth.forgot.resent': "Código reenviado.",
      'auth.forgot.success': "Contraseña actualizada. Inicia sesión con tu nueva contraseña.",
      'auth.forgot.err.code': "Por favor introduce el código completo de 6 dígitos.",
      'auth.forgot.err.invalid': "Código no válido. Revisa tu email e inténtalo de nuevo.",
      'plans.billing.monthly': "Mensual",
      'plans.billing.annual': "Anual",
      'plans.billing.save': "Ahorra ~20%",
      'plans.billing.billed_annual': "Facturado {amt} / año",
      'plans.billing.per_year': "/ año",
    }
  };

    // Merge auth translations into main i18n
  Object.keys(authI18n).forEach(lang => {
    if (i18n[lang]) Object.assign(i18n[lang], authI18n[lang]);
  });

  let currentLang     = 'it';
  let selectedBilling = 'monthly'; // 'monthly' | 'annual' — deve stare prima di updatePrices

  /* ── CURRENCY CONVERSION ── */
  let usdRate = null; // will be fetched

  async function fetchUsdRate() {
    try {
      const res = await fetch('https://api.frankfurter.app/latest?from=EUR&to=USD');
      if (res.ok) {
        const data = await res.json();
        usdRate = data.rates && data.rates.USD ? data.rates.USD : 1.08;
      } else {
        usdRate = 1.08; // fallback
      }
    } catch (e) {
      usdRate = 1.08; // fallback
    }
  }

  function updatePrices(lang) {
    const isEn    = lang === 'en';
    const isAnnual = selectedBilling === 'annual';
    const rate    = usdRate || 1.08;
    const t       = i18n[lang] || i18n.it;
    const sym     = isEn ? '$' : '€';

    const plans = [
      { idx:1, eur:4,  eurAnn:39  },
      { idx:2, eur:12, eurAnn:115 },
      { idx:3, eur:29, eurAnn:278 },
    ];

    plans.forEach(p => {
      const currEl  = document.getElementById('currency-' + p.idx);
      const amtEl   = document.getElementById('amount-'   + p.idx);
      const origEl  = document.getElementById('original-' + p.idx);
      const noteEl  = document.getElementById('note-'     + p.idx);
      const perEl   = document.getElementById('period-'   + p.idx);
      if (!currEl || !amtEl) return;

      if (isAnnual) {
        const annualEur = p.eurAnn;
        const monthly   = isEn ? Math.round(p.eur    * rate) : p.eur;
        const annual    = isEn ? Math.round(annualEur * rate) : annualEur;
        const moEquiv   = isEn
          ? '$' + (Math.round(annualEur * rate / 12 * 10) / 10).toFixed(1)
          : '€' + (annualEur / 12).toFixed(2).replace('.', ',');

        currEl.textContent = sym;
        amtEl.textContent  = isEn ? Math.round(annualEur * rate / 12 * 10) / 10 : (annualEur / 12).toFixed(2).replace('.', ',');
        if (perEl) perEl.setAttribute('data-i18n', 'permonth');
        if (origEl) { origEl.textContent = sym + monthly; origEl.classList.add('show'); }
        if (noteEl) {
          const noteKey = 'plans.billing.billed_' + ['','explorer','prestige','elite'][p.idx];
          const noteText = (t['plans.billing.billed_annual'] || 'Fatturato {amt} / anno')
            .replace('{amt}', sym + annual);
          noteEl.textContent = noteText;
          noteEl.classList.add('show');
        }
      } else {
        const monthly = isEn ? Math.round(p.eur * rate) : p.eur;
        currEl.textContent = sym;
        amtEl.textContent  = monthly;
        if (origEl) origEl.classList.remove('show');
        if (noteEl) noteEl.classList.remove('show');
      }
    });
  }

  /* ── DYNAMIC COPYRIGHT YEAR ── */
  function updateCopyrightYear() {
    const year = new Date().getFullYear();
    const t = i18n[currentLang];
    if (t && t['footer.copy']) {
      const footerEl = document.getElementById('footer-copy');
      if (footerEl) footerEl.innerHTML = t['footer.copy'].replace('YEAR', year);
    }
  }

  function applyTranslations(lang) {
    const t = i18n[lang];
    if (!t) return;
    document.documentElement.lang = lang;
    document.querySelectorAll('[data-i18n]').forEach(el => {
      const key = el.dataset.i18n;
      if (t[key] !== undefined) {
        if (key === 'footer.copy') {
          el.innerHTML = t[key].replace('YEAR', new Date().getFullYear());
        } else {
          el.innerHTML = t[key];
        }
      }
    });
  }

  function setLang(lang) {
    currentLang = lang;
    applyTranslations(lang);
    updatePrices(lang);
    document.querySelectorAll('.lang-btn').forEach(btn => {
      btn.classList.toggle('active', btn.dataset.lang === lang);
    });
  }

  // Fetch USD rate on page load then apply
  fetchUsdRate();

  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => setLang(btn.dataset.lang));
  });

  /* ── NAV SCROLL ── */
  const navbar = document.getElementById('navbar');
  window.addEventListener('scroll', () => {
    navbar.classList.toggle('scrolled', window.scrollY > 50);
  }, { passive: true });

  /* ── MOBILE NAV ── */
  const navToggle = document.getElementById('navToggle');
  const navOverlay = document.getElementById('navOverlay');
  navToggle.addEventListener('click', () => {
    const open = navOverlay.classList.toggle('open');
    navToggle.classList.toggle('open', open);
    document.body.style.overflow = open ? 'hidden' : '';
  });
  navOverlay.querySelectorAll('a').forEach(a => {
    a.addEventListener('click', () => {
      navOverlay.classList.remove('open');
      navToggle.classList.remove('open');
      document.body.style.overflow = '';
    });
  });

  /* ── SCROLL REVEAL ── */
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        e.target.classList.add('visible');
        observer.unobserve(e.target);
      }
    });
  }, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });

  document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

  // Initialize on load
  applyTranslations('it');
  updatePrices('it');

  /* ═══════════════════════════════════════════
     CONFIGURATION — sostituisci con i tuoi URL
  ═══════════════════════════════════════════ */
  const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyLb-E_43gf3inu4cC062Cn-OpbXK1fM8QiflQ8k6F_uxRrorcTVhWVUOgOWTJrOFwa/exec';
  // Stripe Publishable Key (usata solo lato client per redirect, nessun dato sensibile)
  const STRIPE_PK = 'pk_test_51SNyL313nkSVo9XZyhMGIN7IgYjtKtaVZJACjcZvcFpaGXxFziU1QskI95o6pLD1X7IghAAzr2q3qQpNNpvtLMUw00b6GnSa1W';

  /* Piano correntemente selezionato */
  let selectedPlan    = null;

  /* Prezzi piani
     priceId / annualPriceId: inserisci i tuoi veri Price ID Stripe
     (es. price_1ABC123xyz...) oppure lascia null per pagamento one-shot dinamico.
     Prezzi annuali: Explorer €39, Prestige €115, Elite €278 (≈ 20% di sconto) */
  const PLAN_DATA = {
    explorer: { nameKey:'p1.name', tier:'Explorer', eurPrice:4,  eurAnnual:39,  priceId:null, annualPriceId:null },
    prestige:  { nameKey:'p2.name', tier:'Prestige',  eurPrice:12, eurAnnual:115, priceId:null, annualPriceId:null },
    elite:     { nameKey:'p3.name', tier:'Élite',     eurPrice:29, eurAnnual:278, priceId:null, annualPriceId:null },
  };

  /* ── STORAGE AUTH ── */
  function getUser() {
    try { return JSON.parse(localStorage.getItem('lh360_user') || 'null'); } catch { return null; }
  }
  function saveUser(u) { localStorage.setItem('lh360_user', JSON.stringify(u)); }
  function removeUser() { localStorage.removeItem('lh360_user'); }

  /* Semplice hash della password (non sostituisce autenticazione server-side reale) */
  async function hashPwd(str) {
    const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str + 'lh360salt'));
    return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
  }

  /* ── NAVBAR USER STATE ── */
  function updateNavUser() {
    const u = getUser();
    const btn = document.getElementById('navUserBtn');
    if (u) {
      btn.classList.add('active');
    } else {
      btn.classList.remove('active');
    }
  }

  /* ── TOAST ── */
  let toastTimer = null;
  function showToast(msg, type = '') {
    const t = document.getElementById('luxToast');
    t.textContent = msg;
    t.className = 'lux-toast' + (type ? ' ' + type : '');
    clearTimeout(toastTimer);
    requestAnimationFrame(() => {
      t.classList.add('show');
      toastTimer = setTimeout(() => t.classList.remove('show'), 3500);
    });
  }

  /* ── BILLING TOGGLE ── */
  function setBilling(period) {
    selectedBilling = period;
    const isAnnual = period === 'annual';
    document.getElementById('billingToggle').checked = isAnnual;
    document.getElementById('lblMonthly').classList.toggle('active', !isAnnual);
    document.getElementById('lblAnnual').classList.toggle('active',   isAnnual);
    document.getElementById('saveBadge').classList.toggle('show',     isAnnual);
    updatePrices(currentLang);
  }

  /* ── PLAN CLICK HANDLER ── */
  /* Rileva se l'URL di Apps Script è ancora il placeholder */
  const IS_SCRIPT_CONFIGURED = !APPS_SCRIPT_URL.includes('YOUR_DEPLOYMENT_ID');

  /* Modalità corrente del modal: 'auth' (login/register) oppure 'checkout' (già loggato) */
  let authModalMode = 'auth';

  function handlePlanClick(planKey, planPrefix) {
    const u = getUser();
    selectedPlan = { key: planKey, prefix: planPrefix, billingPeriod: selectedBilling, ...PLAN_DATA[planKey] };

    if (u) {
      // Già loggato → apri modal direttamente in modalità checkout
      openCheckoutModal(u);
    } else {
      openAuthModal();
    }
  }

  /* ── APRI IN MODALITÀ CHECKOUT (utente loggato) ── */
  function openCheckoutModal(user) {
    authModalMode = 'checkout';
    updateAuthBanner();

    const overlay = document.getElementById('authOverlay');
    const t = i18n[currentLang] || i18n.it;

    // Titolo
    document.getElementById('authTitle').textContent = t['auth.checkout.title'] || 'Procedi al pagamento';

    // Nascondi tabs e form, mostra solo loading
    document.getElementById('authTabs').style.display = 'none';
    document.getElementById('formRegister').style.display = 'none';
    document.getElementById('formLogin').style.display = 'none';
    document.getElementById('authError').classList.remove('show');
    document.getElementById('stripeLoading').style.display = 'block';

    overlay.classList.add('open');
    document.body.style.overflow = 'hidden';

    // Avvia checkout subito
    initiateStripeCheckout(user);
  }

  /* ── AUTH MODAL ── */
  function openAuthModal() {
    authModalMode = 'auth';
    const overlay = document.getElementById('authOverlay');
    updateAuthBanner();

    // Ripristina tabs e titolo
    document.getElementById('authTabs').style.display = '';
    overlay.classList.add('open');
    document.body.style.overflow = 'hidden';
    switchTab('register');
  }

  function closeAuthModal() {
    document.getElementById('authOverlay').classList.remove('open');
    document.body.style.overflow = '';
    document.getElementById('stripeLoading').style.display = 'none';
    document.getElementById('authError').classList.remove('show');
    // Ripristina tabs se erano nascosti
    document.getElementById('authTabs').style.display = '';
    // Pulisci area errore checkout
    const errArea = document.getElementById('checkoutErrorArea');
    if (errArea) errArea.style.display = 'none';
    // Chiudi eventuale pannello "password dimenticata"
    document.getElementById('formForgotPwd').style.display = 'none';
    authModalMode = 'auth';
  }
  document.getElementById('authOverlay').addEventListener('click', function(e) {
    if (e.target === this) closeAuthModal();
  });

  function updateAuthBanner() {
    if (!selectedPlan) return;
    const t      = i18n[currentLang] || i18n.it;
    const isEn   = currentLang === 'en';
    const isAnn  = selectedPlan.billingPeriod === 'annual';
    const rate   = usdRate || 1.08;
    const sym    = isEn ? '$' : '€';
    const baseEur = isAnn ? selectedPlan.eurAnnual : selectedPlan.eurPrice;
    const amount  = isEn ? Math.round(baseEur * rate) : baseEur;
    const period  = isAnn
      ? (t['plans.billing.per_year'] || '/ anno')
      : (t['permonth']               || '/ mese');
    document.getElementById('authPlanName').textContent  = selectedPlan.tier + ' — ' + (t[selectedPlan.nameKey] || '');
    document.getElementById('authPlanPrice').textContent = sym + amount + ' ' + period;
  }

  function switchTab(tab) {
    const isReg = tab === 'register';
    document.getElementById('formRegister').style.display = isReg ? '' : 'none';
    document.getElementById('formLogin').style.display = isReg ? 'none' : '';
    document.getElementById('formForgotPwd').style.display = 'none';
    document.getElementById('tabRegister').classList.toggle('active', isReg);
    document.getElementById('tabLogin').classList.toggle('active', !isReg);
    document.getElementById('authError').classList.remove('show');
    const t = i18n[currentLang] || i18n.it;
    document.getElementById('authTitle').textContent = isReg
      ? (t['auth.register.title'] || 'Crea il tuo account')
      : (t['auth.login.title'] || 'Accedi');
  }

  /* ── PASSWORD STRENGTH ── */
  function checkPwdStrength(v) {
    // Aggiorna la barra del form attivo (registrazione o reset)
    const bar = document.getElementById(
      document.getElementById('formForgotPwd').style.display !== 'none' ? 'resetPwdBar' : 'pwdBar'
    );
    if (!bar) return;
    let score = 0;
    if (v.length >= 8) score++;
    if (/[A-Z]/.test(v)) score++;
    if (/[0-9]/.test(v)) score++;
    if (/[^A-Za-z0-9]/.test(v)) score++;
    const colors = ['#ff6b6b','#ffa94d','#ffe066','#4ade80'];
    bar.style.width = (score * 25) + '%';
    bar.style.background = colors[score - 1] || 'transparent';
  }

  function showAuthError(msg) {
    const el = document.getElementById('authError');
    el.textContent = msg;
    el.classList.add('show');
  }

  /* ── REGISTER ── */
  async function handleRegister() {
    const btn = document.getElementById('btnRegister');
    const t = i18n[currentLang] || i18n.it;
    const firstName = document.getElementById('regFirstName').value.trim();
    const lastName  = document.getElementById('regLastName').value.trim();
    const email     = document.getElementById('regEmail').value.trim().toLowerCase();
    const pwd       = document.getElementById('regPassword').value;
    const pwd2      = document.getElementById('regPasswordConfirm').value;

    if (!firstName || !lastName) return showAuthError(t['auth.err.name'] || 'Inserisci nome e cognome.');
    if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email))
      return showAuthError(t['auth.err.email'] || 'Email non valida.');
    if (pwd.length < 8)
      return showAuthError(t['auth.err.pwdlen'] || 'La password deve avere almeno 8 caratteri.');
    if (pwd !== pwd2)
      return showAuthError(t['auth.err.pwdmatch'] || 'Le password non coincidono.');

    // Controlla se l'account esiste già
    const existing = JSON.parse(localStorage.getItem('lh360_accounts') || '{}');
    if (existing[email]) {
      showAuthError(t['auth.err.exists'] || 'Account già esistente. Accedi.');
      switchTab('login');
      document.getElementById('loginEmail').value = email;
      return;
    }

    btn.disabled = true;
    btn.textContent = '...';

    const hash = await hashPwd(pwd);
    existing[email] = { firstName, lastName, email, hash };
    localStorage.setItem('lh360_accounts', JSON.stringify(existing));

    const user = { firstName, lastName, email, subscription: null };
    saveUser(user);
    updateNavUser();

    await proceedToStripe(user);
    btn.disabled = false;
  }

  /* ── LOGIN ── */
  async function handleLogin() {
    const btn = document.getElementById('btnLogin');
    const t = i18n[currentLang] || i18n.it;
    const email = document.getElementById('loginEmail').value.trim().toLowerCase();
    const pwd   = document.getElementById('loginPassword').value;

    if (!email || !pwd) return showAuthError(t['auth.err.empty'] || 'Compila tutti i campi.');

    const accounts = JSON.parse(localStorage.getItem('lh360_accounts') || '{}');
    const acc = accounts[email];
    if (!acc) return showAuthError(t['auth.err.notfound'] || 'Account non trovato. Registrati.');

    const hash = await hashPwd(pwd);
    if (hash !== acc.hash) return showAuthError(t['auth.err.wrongpwd'] || 'Password errata.');

    btn.disabled = true;
    btn.textContent = '...';

    const user = { firstName: acc.firstName, lastName: acc.lastName, email, subscription: acc.subscription || null };
    saveUser(user);
    updateNavUser();

    await proceedToStripe(user);
    btn.disabled = false;
  }

  /* ── STRIPE CHECKOUT ── */
  async function proceedToStripe(user) {
    // Pulisci eventuale area errore da tentativi precedenti
    const prevErr = document.getElementById('checkoutErrorArea');
    if (prevErr) prevErr.style.display = 'none';

    document.getElementById('formRegister').style.display = 'none';
    document.getElementById('formLogin').style.display = 'none';
    document.getElementById('stripeLoading').style.display = 'block';

    await initiateStripeCheckout(user);
  }

  async function initiateStripeCheckout(user) {
    if (!selectedPlan) return;

    /* ── Controlla configurazione ── */
    if (!IS_SCRIPT_CONFIGURED) {
      const t = i18n[currentLang] || i18n.it;
      _checkoutError(t['auth.err.notconfigured'] ||
        '⚙️ Apps Script non configurato. Incolla il tuo URL di distribuzione nella variabile APPS_SCRIPT_URL nel file index.html.');
      return;
    }

    try {
      const isEn     = currentLang === 'en';
      const rate     = usdRate || 1.08;
      const currency = isEn ? 'usd' : 'eur';
      const isAnnual = selectedPlan.billingPeriod === 'annual';

      /* Prezzo da inviare a Stripe */
      const baseEur  = isAnnual ? selectedPlan.eurAnnual : selectedPlan.eurPrice;
      const price    = isEn ? Math.round(baseEur * rate) : baseEur;

      /* Price ID: usa quello annuale se disponibile e siamo in modalità annuale */
      const priceId  = isAnnual
        ? (selectedPlan.annualPriceId || null)
        : (selectedPlan.priceId       || null);

      const payload = {
        action: 'createCheckout',
        user: {
          firstName: user.firstName,
          lastName: user.lastName,
          email: user.email
        },
        plan: {
          key:           selectedPlan.key,
          tier:          selectedPlan.tier,
          price:         price,
          currency:      currency,
          priceId:       priceId,
          billingPeriod: selectedPlan.billingPeriod || 'monthly',
        },
        lang:       currentLang,
        successUrl: window.location.href.split('?')[0] + '?success=1&plan=' + selectedPlan.key + '&billing=' + (selectedPlan.billingPeriod||'monthly'),
        cancelUrl:  window.location.href.split('?')[0] + '?cancelled=1'
      };

      const res = await fetch(APPS_SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify(payload),
        headers: { 'Content-Type': 'text/plain' }
      });
      const data = await res.json();
      if (data.url) {
        window.location.href = data.url;
      } else {
        throw new Error(data.error || 'Errore Stripe');
      }
    } catch (e) {
      const t = i18n[currentLang] || i18n.it;
      const msg = e.message && e.message.includes('Stripe')
        ? e.message
        : (t['auth.err.connection'] || 'Errore di connessione. Verifica la configurazione di Apps Script e riprova.');
      _checkoutError(msg);
    }
  }

  /* Helper: mostra errore nel modal (funziona in qualsiasi modalità) */
  function _checkoutError(msg) {
    // Assicura che il modal sia aperto
    document.getElementById('authOverlay').classList.add('open');
    document.body.style.overflow = 'hidden';

    // Nascondi loading
    document.getElementById('stripeLoading').style.display = 'none';

    if (authModalMode === 'checkout') {
      // Utente loggato: mostra errore con pulsante chiudi
      document.getElementById('authTabs').style.display = 'none';
      document.getElementById('formRegister').style.display = 'none';
      document.getElementById('formLogin').style.display = 'none';

      // Crea o aggiorna area errore checkout
      let errArea = document.getElementById('checkoutErrorArea');
      if (!errArea) {
        errArea = document.createElement('div');
        errArea.id = 'checkoutErrorArea';
        errArea.style.cssText = 'padding: 1rem 0; text-align: center;';
        document.getElementById('stripeLoading').insertAdjacentElement('afterend', errArea);
      }
      const t = i18n[currentLang] || i18n.it;
      errArea.style.display = 'block';
      errArea.innerHTML = `
        <div class="lux-error show" style="display:block; text-align:left; margin-bottom:1.25rem;">${msg}</div>
        <button class="lux-submit" onclick="closeAuthModal()" style="background: var(--border); color: var(--muted);">
          ${t['auth.close'] || 'Chiudi'}
        </button>
      `;
    } else {
      // Flusso registrazione/login: ripristina il form corretto
      const activeForm = document.getElementById('tabRegister')?.classList.contains('active')
        ? 'register' : 'login';
      document.getElementById('formRegister').style.display = activeForm === 'register' ? '' : 'none';
      document.getElementById('formLogin').style.display = activeForm === 'login' ? '' : 'none';

      showAuthError(msg);

      // Riabilita pulsanti
      const btnReg = document.getElementById('btnRegister');
      const btnLog = document.getElementById('btnLogin');
      if (btnReg) { btnReg.disabled = false; applyTranslations(currentLang); }
      if (btnLog) { btnLog.disabled = false; applyTranslations(currentLang); }
    }
  }

  /* ── SUCCESS CALLBACK (dopo redirect da Stripe) ── */
  async function handleStripeCallback() {
    const params = new URLSearchParams(window.location.search);
    if (params.get('success') === '1') {
      const planKey = params.get('plan');
      const user = getUser();
      const billingBack = params.get('billing') || 'monthly';
      if (user && planKey && PLAN_DATA[planKey]) {
        const now    = new Date();
        const expire = new Date(now);
        if (billingBack === 'annual') {
          expire.setFullYear(expire.getFullYear() + 1);
        } else {
          expire.setMonth(expire.getMonth() + 1);
        }

        user.subscription = {
          plan:          planKey,
          tier:          PLAN_DATA[planKey].tier,
          status:        'active',
          billingPeriod: billingBack,
          startDate:     now.toISOString().split('T')[0],
          expireDate:    expire.toISOString().split('T')[0],
          autoRenew:     true
        };
        saveUser(user);

        // Aggiorna account salvato
        const accounts = JSON.parse(localStorage.getItem('lh360_accounts') || '{}');
        if (accounts[user.email]) {
          accounts[user.email].subscription = user.subscription;
          localStorage.setItem('lh360_accounts', JSON.stringify(accounts));
        }

        // Salva su Sheets tramite Apps Script
        try {
          await fetch(APPS_SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify({
              action: 'saveSubscription',
              user: user,
              subscription: user.subscription
            }),
            headers: { 'Content-Type': 'text/plain' }
          });
        } catch(e) {}

        updateNavUser();
        const t = i18n[currentLang] || i18n.it;
        showToast((t['toast.welcome'] || 'Benvenuto!') + ' ' + user.firstName + ' 🎉', 'success');
      }
      // Pulisci URL
      window.history.replaceState({}, document.title, window.location.pathname);
    } else if (params.get('cancelled') === '1') {
      window.history.replaceState({}, document.title, window.location.pathname);
    }
  }

  /* ── PROFILE MODAL ── */
  function openProfileModal() {
    const u = getUser();
    if (!u) return;
    const t = i18n[currentLang] || i18n.it;
    const overlay = document.getElementById('profileOverlay');

    document.getElementById('profileAvatar').textContent = u.firstName.charAt(0).toUpperCase();
    document.getElementById('profileName').textContent = u.firstName + ' ' + u.lastName;
    document.getElementById('profileEmail').textContent = u.email;

    const sub = u.subscription;
    if (sub) {
      const tierName = t[PLAN_DATA[sub.plan]?.nameKey] || sub.tier;
      document.getElementById('profilePlan').textContent = sub.tier + ' — ' + tierName;

      const statusEl = document.getElementById('profileStatus');
      const isActive = sub.status === 'active';
      statusEl.textContent = isActive ? (t['profile.badge.active']||'Attivo') : (t['profile.badge.inactive']||'Non attivo');
      statusEl.className = 'profile-badge ' + (isActive ? 'active' : 'none');

      document.getElementById('profileStart').textContent  = sub.startDate  || '—';
      document.getElementById('profileExpire').textContent = sub.expireDate || '—';
      document.getElementById('profileRenew').textContent  = sub.autoRenew ? (t['profile.yes']||'Sì') : (t['profile.no']||'No');

      const billingVal = sub.billingPeriod === 'annual'
        ? (t['plans.billing.annual']  || 'Annuale')
        : (t['plans.billing.monthly'] || 'Mensile');
      document.getElementById('profileBilling').textContent = billingVal;

      // Mostra pulsante cancellazione solo se abbonamento attivo
      const cancelZone = document.getElementById('profileCancelZone');
      if (cancelZone) cancelZone.style.display = isActive ? '' : 'none';
      hideCancelConfirm();
    } else {
      document.getElementById('profilePlan').textContent = t['profile.no_plan'] || 'Nessun piano attivo';
      const statusEl = document.getElementById('profileStatus');
      statusEl.textContent = t['profile.badge.none'] || 'Non attivo';
      statusEl.className = 'profile-badge none';
      document.getElementById('profileStart').textContent   = '—';
      document.getElementById('profileExpire').textContent  = '—';
      document.getElementById('profileRenew').textContent   = '—';
      document.getElementById('profileBilling').textContent = '—';
      const cancelZone = document.getElementById('profileCancelZone');
      if (cancelZone) cancelZone.style.display = 'none';
    }

    overlay.classList.add('open');
    document.body.style.overflow = 'hidden';
  }
  function closeProfileModal() {
    document.getElementById('profileOverlay').classList.remove('open');
    document.body.style.overflow = '';
  }
  document.getElementById('profileOverlay').addEventListener('click', function(e) {
    if (e.target === this) closeProfileModal();
  });

  function handleUpgrade() {
    closeProfileModal();
    document.getElementById('subscriptions').scrollIntoView({ behavior: 'smooth' });
  }

  function handleLogout() {
    removeUser();
    updateNavUser();
    closeProfileModal();
    const t = i18n[currentLang] || i18n.it;
    showToast(t['toast.logout'] || 'Disconnesso.', '');
  }

  /* ── CANCEL SUBSCRIPTION ── */
  function showCancelConfirm() {
    document.getElementById('cancelConfirmBox').classList.add('show');
    document.getElementById('profileCancelBtn').style.display = 'none';
  }
  function hideCancelConfirm() {
    const box = document.getElementById('cancelConfirmBox');
    const btn = document.getElementById('profileCancelBtn');
    if (box) box.classList.remove('show');
    if (btn) btn.style.display = '';
  }

  async function handleCancelSubscription() {
    const u = getUser();
    if (!u || !u.subscription) return;
    const t = i18n[currentLang] || i18n.it;

    // Aggiorna stato locale
    u.subscription.status    = 'cancelled';
    u.subscription.autoRenew = false;
    saveUser(u);

    const accounts = JSON.parse(localStorage.getItem('lh360_accounts') || '{}');
    if (accounts[u.email]) {
      accounts[u.email].subscription = u.subscription;
      localStorage.setItem('lh360_accounts', JSON.stringify(accounts));
    }

    // Notifica Apps Script
    try {
      await fetch(APPS_SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ action: 'cancelSubscription', email: u.email }),
        headers: { 'Content-Type': 'text/plain' }
      });
    } catch(e) { /* non blocca l'UX */ }

    closeProfileModal();
    showToast(t['profile.cancel_toast'] || 'Abbonamento terminato.', '');
  }

  /* ── KEYBOARD CLOSE ── */
  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
      closeAuthModal();
      closeProfileModal();
    }
  });

  /* ── FORGOT PASSWORD ── */
  let _resetEmailCache = '';

  function openForgotPassword() {
    document.getElementById('formLogin').style.display = 'none';
    document.getElementById('formForgotPwd').style.display = '';
    document.getElementById('authError').classList.remove('show');
    // Pre-fill email if the user already typed it
    const loginEmail = document.getElementById('loginEmail').value.trim();
    if (loginEmail) document.getElementById('resetEmail').value = loginEmail;
    goToResetStep(1);
    const t = i18n[currentLang] || i18n.it;
    document.getElementById('authTitle').textContent = t['auth.forgot.title'] || 'Ripristina password';
  }

  function closeForgotPassword() {
    document.getElementById('formForgotPwd').style.display = 'none';
    document.getElementById('formLogin').style.display = '';
    document.getElementById('authError').classList.remove('show');
    const t = i18n[currentLang] || i18n.it;
    document.getElementById('authTitle').textContent = t['auth.login.title'] || 'Accedi al tuo account';
  }

  function goToResetStep(step) {
    document.querySelectorAll('.lux-reset-step').forEach((el, i) => {
      el.classList.toggle('active', i + 1 === step);
    });
    document.getElementById('authError').classList.remove('show');
    // Clear OTP inputs when going back to step 1
    if (step === 1) {
      document.querySelectorAll('.lux-otp-input').forEach(el => el.value = '');
    }
  }

  async function handleSendReset(isResend = false) {
    const t = i18n[currentLang] || i18n.it;
    const email = document.getElementById('resetEmail').value.trim().toLowerCase();
    if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
      return showAuthError(t['auth.err.email'] || 'Email non valida.');
    }

    _resetEmailCache = email;
    const btn = document.getElementById('btnSendReset');
    btn.disabled = true;
    btn.textContent = '...';

    try {
      const res = await fetch(APPS_SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ action: 'sendPasswordReset', email }),
        headers: { 'Content-Type': 'text/plain' }
      });
      const data = await res.json();
      if (data.success) {
        goToResetStep(2);
        document.getElementById('authError').classList.remove('show');
        if (isResend) showToast(t['auth.forgot.resent'] || 'Codice inviato di nuovo.', 'success');
        // Focus primo campo OTP
        setTimeout(() => {
          const first = document.querySelector('.lux-otp-input');
          if (first) first.focus();
        }, 100);
      } else {
        showAuthError(data.error || t['auth.err.connection'] || 'Errore di connessione.');
      }
    } catch (e) {
      showAuthError(t['auth.err.connection'] || 'Errore di connessione.');
    } finally {
      btn.disabled = false;
      applyTranslations(currentLang);
    }
  }

  /* Avanzamento automatico tra le celle OTP */
  function otpNext(input, idx) {
    input.value = input.value.replace(/\D/g, '').slice(-1);
    const inputs = document.querySelectorAll('.lux-otp-input');
    if (input.value && idx < 5) inputs[idx + 1].focus();
    // Backspace support
    input.addEventListener('keydown', function(e) {
      if (e.key === 'Backspace' && !this.value && idx > 0) {
        inputs[idx - 1].focus();
      }
    }, { once: true });
  }

  /* Gestisce anche il paste di 6 cifre nell'OTP */
  document.addEventListener('paste', function(e) {
    const otpArea = document.getElementById('otpInputs');
    if (!otpArea || !otpArea.contains(document.activeElement)) return;
    const text = (e.clipboardData || window.clipboardData).getData('text').replace(/\D/g, '').slice(0, 6);
    if (text.length < 2) return;
    e.preventDefault();
    document.querySelectorAll('.lux-otp-input').forEach((el, i) => {
      el.value = text[i] || '';
    });
  });

  async function handleConfirmReset() {
    const t = i18n[currentLang] || i18n.it;
    const otpInputs = document.querySelectorAll('.lux-otp-input');
    const code = Array.from(otpInputs).map(el => el.value).join('');
    if (code.length < 6) return showAuthError(t['auth.forgot.err.code'] || 'Inserisci il codice completo a 6 cifre.');

    const newPwd = document.getElementById('resetNewPwd').value;
    const confirmPwd = document.getElementById('resetConfirmPwd').value;
    if (newPwd.length < 8) return showAuthError(t['auth.err.pwdlen'] || 'La password deve avere almeno 8 caratteri.');
    if (newPwd !== confirmPwd) return showAuthError(t['auth.err.pwdmatch'] || 'Le password non coincidono.');

    const btn = document.getElementById('btnConfirmReset');
    btn.disabled = true;
    btn.textContent = '...';

    try {
      const res = await fetch(APPS_SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify({ action: 'verifyResetCode', email: _resetEmailCache, code }),
        headers: { 'Content-Type': 'text/plain' }
      });
      const data = await res.json();
      if (data.valid) {
        // Aggiorna la password nell'account locale
        const accounts = JSON.parse(localStorage.getItem('lh360_accounts') || '{}');
        if (accounts[_resetEmailCache]) {
          const hash = await hashPwd(newPwd);
          accounts[_resetEmailCache].hash = hash;
          localStorage.setItem('lh360_accounts', JSON.stringify(accounts));

          // Se l'utente è loggato con questo account, aggiorna anche la sessione
          const u = getUser();
          if (u && u.email === _resetEmailCache) {
            u.subscription = accounts[_resetEmailCache].subscription || u.subscription;
            saveUser(u);
          }
        }
        // Torna al login con messaggio di successo
        document.getElementById('formForgotPwd').style.display = 'none';
        document.getElementById('formLogin').style.display = '';
        document.getElementById('loginEmail').value = _resetEmailCache;
        const t2 = i18n[currentLang] || i18n.it;
        document.getElementById('authTitle').textContent = t2['auth.login.title'] || 'Accedi al tuo account';
        showToast(t2['auth.forgot.success'] || 'Password aggiornata. Accedi con la nuova password.', 'success');
        _resetEmailCache = '';
      } else {
        showAuthError(data.error || t['auth.forgot.err.invalid'] || 'Codice non valido. Riprova.');
      }
    } catch (e) {
      showAuthError(t['auth.err.connection'] || 'Errore di connessione.');
    } finally {
      btn.disabled = false;
      applyTranslations(currentLang);
    }
  }

  /* ── INIT ── */
  updateNavUser();
  handleStripeCallback();


</script>
</body>
</html>
